<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Kalmar CTF 2023 Write-ups - Pinox&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Pinox&#039;s Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Pinox&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Mình vừa tham gia giải KalmarCTF 2023, mình giải được 4 bài, trong đó mảng Crypto làm được 2 bài dễ nhất liên quan đến One Time Pad :)) Bài Crypto thứ 3 mình có đọc và nghĩ hướng giải là …, nhưng mìn"><meta property="og:type" content="blog"><meta property="og:title" content="Kalmar CTF 2023 Write-ups"><meta property="og:url" content="https://pinox0x0.github.io/2023/kalmar-ctf-2023-write-ups/"><meta property="og:site_name" content="Pinox&#039;s Blog"><meta property="og:description" content="Mình vừa tham gia giải KalmarCTF 2023, mình giải được 4 bài, trong đó mảng Crypto làm được 2 bài dễ nhất liên quan đến One Time Pad :)) Bài Crypto thứ 3 mình có đọc và nghĩ hướng giải là …, nhưng mìn"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://pinox0x0.github.io/src/2023/Kalmar-CTF-2023/kalmar-ctf-result.jpg"><meta property="article:published_time" content="2023-03-06T09:00:00.000Z"><meta property="article:modified_time" content="2023-03-24T22:00:52.930Z"><meta property="article:author" content="Pinox0x0"><meta property="article:tag" content="crypto"><meta property="article:tag" content="CTF"><meta property="article:tag" content="WriteUp"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://pinox0x0.github.io/src/2023/Kalmar-CTF-2023/kalmar-ctf-result.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://pinox0x0.github.io/2023/kalmar-ctf-2023-write-ups/"},"headline":"Kalmar CTF 2023 Write-ups","image":["https://pinox0x0.github.io/src/2023/Kalmar-CTF-2023/kalmar-ctf-result.jpg"],"datePublished":"2023-03-06T09:00:00.000Z","dateModified":"2023-03-24T22:00:52.930Z","author":{"@type":"Person","name":"Pinox0x0"},"publisher":{"@type":"Organization","name":"Pinox's Blog","logo":{"@type":"ImageObject","url":{"text":"Pinox0x0's Blog"}}},"description":"Mình vừa tham gia giải KalmarCTF 2023, mình giải được 4 bài, trong đó mảng Crypto làm được 2 bài dễ nhất liên quan đến One Time Pad :)) Bài Crypto thứ 3 mình có đọc và nghĩ hướng giải là …, nhưng mìn"}</script><link rel="canonical" href="https://pinox0x0.github.io/2023/kalmar-ctf-2023-write-ups/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Pinox0x0&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/tools">Tools</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-03-06T09:00:00.000Z" title="12:00:00 6/3/2023">2023-03-06</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-03-24T22:00:52.930Z" title="01:00:52 25/3/2023">2023-03-25</time></span><span class="level-item"><a class="link-muted" href="/categories/CTF-Write-ups/">CTF Write-ups</a></span><span class="level-item">20 minutes read (About 3047 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Kalmar CTF 2023 Write-ups</h1><div class="content"><p><img src="/src/2023/Kalmar-CTF-2023/kalmar-ctf-result.jpg"></p>
<p>Mình vừa tham gia giải KalmarCTF 2023, mình giải được 4 bài, trong đó mảng Crypto làm được 2 bài dễ nhất liên quan đến One Time Pad :)) Bài Crypto thứ 3 mình có đọc và nghĩ hướng giải là …, nhưng mình vẫn chưa tìm ra cách nào để giảm thời gian làm bài xuống.</p>
<span id="more"></span>

<p>Vì thời điểm mình viết write-up sau thời gian kết thúc làm bài nên không lấy được đề một số bài, mình sẽ update trong thời gian tới.</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Sanity-Check-100"><a href="#Sanity-Check-100" class="headerlink" title="Sanity Check (100)"></a>Sanity Check (100)</h2><blockquote>
<p>Have you read the rules?</p>
</blockquote>
<p>Chỉ đơn giản là đọc rules và lấy flag.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kalmar&#123;i_have_read_the_rules_and_each_player_has_their_own_account&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h1><h2 id="sewing-waste-and-agriculture-leftovers-100"><a href="#sewing-waste-and-agriculture-leftovers-100" class="headerlink" title="sewing-waste-and-agriculture-leftovers (100)"></a>sewing-waste-and-agriculture-leftovers (100)</h2><p>Đối với bài mình sử dụng công cụ <em>wireshark</em>, vào <code>Analyze &gt;&gt; Follow &gt;&gt; UDP Stream</code> ta thấy có thể ghép chữ cái từ những stream khác nhau lại để tạo thành flag có nghĩa.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">..l..r&#123;....t..i........d0.._.....e..m...e...u.......g.....</span><br><span class="line">.a..a.&#123;.._4..........._d0.._..c.......y.e..ou.._.s........</span><br><span class="line">k..m....f_....ir........0.............y.......e..s1.......</span><br><span class="line">k..m.......t......_..u..0.........d.m.......ur.............</span><br><span class="line">...m.r....4....r...yo..d0.....c..e...a............1...u....</span><br><span class="line">.....r..._...fi..._....d..._.ucc........e..ou......n...dp&#125;</span><br><span class="line">....a.....4._.i.s._..u...nt_.....e........y...........ud...</span><br><span class="line">k..m....._.......t...u.......ucc....m................_.....</span><br><span class="line">..l...&#123;....t..i.s..y.u...n._..........y.......e........d..</span><br><span class="line">...ma......._....t..........s...e.......e.............u..&#125;.</span><br><span class="line">k.l.a.&#123;i...._....t.....d..._.................r.............</span><br><span class="line">..l............r......_d.n..s..............o..........u.p..</span><br><span class="line">...m.......t.f............t.............e....r..us.........</span><br><span class="line">....a........fir.t..o..d....s.cc....m.yb..y.........g..d...</span><br><span class="line">.alma.....4...i........d.n........._..........._...n.......</span><br><span class="line">..l.a...._4.........o..d0.t..u......ma.b._.........n.....&#125;.</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kalmar&#123;if_4t_first_you_d0nt_succeed_maybe_youre_us1ng_udp&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="BabyOneTimePad-100"><a href="#BabyOneTimePad-100" class="headerlink" title="BabyOneTimePad (100)"></a>BabyOneTimePad (100)</h2><blockquote>
<p>I read about how encryption with one-time pads is unbreakable, so no one will be able to solve this challenge.<br><code>nc 3.120.132.103 13338</code> </p>
</blockquote>
<figure class="highlight python"><figcaption><span>challenge.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &quot;BabyOneTimePad&quot; challenge for KalmarCTF 2023</span></span><br><span class="line"><span class="comment"># based on &quot;EasyOneTimePad&quot;</span></span><br><span class="line"><span class="comment"># original challenge by shalaamum</span></span><br><span class="line"><span class="comment"># idea to make this easier variant by killerdog</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">PASS_LENGTH_BYTES = <span class="number">128</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_otp</span>(<span class="params">cleartext, key = os.urandom(<span class="params">PASS_LENGTH_BYTES</span>)</span>):</span><br><span class="line">    ciphertext = <span class="built_in">bytes</span>([key[i % <span class="built_in">len</span>(key)] ^ x <span class="keyword">for</span> i,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(cleartext.<span class="built_in">hex</span>().encode())])</span><br><span class="line">    <span class="keyword">return</span> ciphertext, key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;According to Wikipedia:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&quot;In cryptography, the one-time pad (OTP) is an encryption technique that cannot be cracked, but requires the use of a single-use pre-shared key that is not smaller than the message being sent.&quot;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;So have fun trying to figure out my password!&#x27;</span>)</span><br><span class="line">    password = os.urandom(PASS_LENGTH_BYTES)</span><br><span class="line"></span><br><span class="line">    enc, _ = encrypt_otp(password)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Here is my password encrypted with a one-time pad: <span class="subst">&#123;enc.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Actually, I will give you my password encrypted another time.&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;This time you are allowed to permute the password first&#x27;</span>)</span><br><span class="line">    permutation = <span class="built_in">input</span>(<span class="string">&#x27;Permutation: &#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        permutation = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> permutation.strip().split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">set</span>(permutation) == <span class="built_in">set</span>(<span class="built_in">range</span>(PASS_LENGTH_BYTES))</span><br><span class="line">        enc, _ = encrypt_otp(<span class="built_in">bytes</span>([password[permutation[i]] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(PASS_LENGTH_BYTES)]))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Here is the permuted password encrypted with another one-time pad: <span class="subst">&#123;enc.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Something went wrong!&#x27;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    password_guess = <span class="built_in">input</span>(<span class="string">&#x27;What is my password: &#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        password_guess = <span class="built_in">bytes</span>.fromhex(password_guess)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Something went wrong!&#x27;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> password_guess == password:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            flag = f.read()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;The flag is <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Nope.&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>Mặc dù bài đầu tiên có nhiều sơ hở hơn so với bài thứ 2 (2 lần mã hóa đều sử dụng chung 1 pad key, không giới hạn độ dài permutation) nhưng mình vẫn không nghĩ ra :)) và vậy là mình giải quyết bài sau trước, sau đó giải quyết bài đầu, hơi ngược tí mà kệ :))</p>
<p>Trong bài này, server sẽ generate 1 string secret, nhiệm vụ của chúng ta là đoán ra secret và server sẽ cho chúng ta biết flag. Cùng xem chúng ta có dữ kiện gì:</p>
<ul>
<li>Chúng ta được biết giá trị đã pad của secret;</li>
<li>Chúng ta được chọn 1 permutation bất kỳ để thay đổi secret, biết được giá trị đã pad của secret sau khi thay đổi;</li>
<li>2 lần pad trên sử dụng 2 key pad khác nhau;</li>
<li>Độ dài của pad key là 128-bit, của secret là 256-bit, do đó pad key được sử dụng lặp lại 1 lần;</li>
</ul>
<p>Gọi nửa đầu của secret là <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"></span></span>, nửa sau là <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"></span></span>. Dựa vào dữ kiện (), ý tưởng làm bài như sau:</p>
<ol>
<li>Lấy giá trị đã XOR với <em>key1</em> của secret <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub><mo>⊕</mo><mi>k</mi><mi>e</mi><msub><mi>y</mi><mn>1</mn></msub><mo>∥</mo><msub><mi>P</mi><mn>1</mn></msub><mo>⊕</mo><mi>k</mi><mi>e</mi><msub><mi>y</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">P_{0}\oplus key_{1}\parallel P_{1}\oplus key_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Tính được <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>12</mn></msub><mo>=</mo><msub><mi>P</mi><mn>0</mn></msub><mo>⊕</mo><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">h_{12}=P_{0}\oplus P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>;</li>
<li>Chọn <em>permutation</em> dịch 1 bytes ở nửa đầu <em>secret</em>, giữ nguyên nửa sau của <em>secret</em>: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>63</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>64</mn><mo separator="true">,</mo><mn>65</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>127</mn><mo fence="true">)</mo></mrow><mo>∈</mo><msub><mi>S</mi><mn>128</mn></msub></mrow><annotation encoding="application/x-tex">\left(1,2,\ldots,63,0,64,65,\ldots,127\right)\in S_{128}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mord">4</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">6</span><span class="mord">5</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mord">7</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>;</li>
<li>Lấy giá trị đã XOR với <em>key2</em> của <em>secret</em> sau khi biến đổi <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><msub><mi>P</mi><mn>0</mn></msub><mo>≫</mo><mn>1</mn><mo fence="true">)</mo></mrow><mo>⊕</mo><mi>k</mi><mi>e</mi><msub><mi>y</mi><mn>2</mn></msub><mo>∥</mo><msub><mi>P</mi><mn>1</mn></msub><mo>⊕</mo><mi>k</mi><mi>e</mi><msub><mi>y</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\left(P_{0}\gg1\right)\oplus key_{2}\parallel P_{1}\oplus key_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Tính được <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>34</mn></msub><mo>=</mo><mrow><mo fence="true">(</mo><msub><mi>P</mi><mn>0</mn></msub><mo>≫</mo><mn>1</mn><mo fence="true">)</mo></mrow><mo>⊕</mo><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">h_{34}=\left(P_{0}\gg1\right)\oplus P_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, trong đó <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub><mo>≫</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">P_{0}\gg1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> là kết quả shift 1 byte của <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> về bên phải;</li>
<li>Tính giá trị <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1234</mn></msub><mo>=</mo><mrow><mo fence="true">(</mo><msub><mi>P</mi><mn>0</mn></msub><mo>≫</mo><mn>1</mn><mo fence="true">)</mo></mrow><mo>⊕</mo><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">h_{1234}=\left(P_{0}\gg1\right)\oplus P_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span><span class="mord mtight">3</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≫</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. Từ đây, chúng ta đoán bytes đầu tiên của <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> sao cho tất cả các bytes còn lại đều hợp lệ;</li>
<li>Tìm được bytes đầu tiên của <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> và giá trị đúng của <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, tính giá trị <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mo>=</mo><msub><mi>h</mi><mn>12</mn></msub><mo>⊕</mo><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_1 = h_{12} \oplus P_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>;</li>
<li>Ghép <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>t</mi><mo>=</mo><msub><mi>P</mi><mn>0</mn></msub><mo>∥</mo><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">secret = P_0 \parallel P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> và submit đáp án.</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;3.120.132.103&quot;</span>, <span class="number">13338</span>)</span><br><span class="line"></span><br><span class="line">enc1 = <span class="built_in">bytes</span>.fromhex(r.recvline_startswith(<span class="string">b&#x27;Here is my password encrypted with a one-time pad:&#x27;</span>).decode().strip(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">51</span>:])</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(enc1) == <span class="number">256</span></span><br><span class="line"></span><br><span class="line">h1 = <span class="built_in">list</span>(enc1[:<span class="number">128</span>])</span><br><span class="line">h2 = <span class="built_in">list</span>(enc1[<span class="number">128</span>:])</span><br><span class="line">h12 = [h1[i] ^ h2[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h12 = &quot;</span>, h12)    <span class="comment">#   --&gt; Kết quả XOR nửa đầu P0 và nửa sau P1 của secret</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#   Chọn permutation như sau:</span></span><br><span class="line"><span class="comment">#   [1, 2, ..., 63, 0, 64, 65, ..., 127]</span></span><br><span class="line"><span class="comment">#   Secret lúc này có dạng nửa đầu P0(&gt;&gt;1) và nửa sau P1</span></span><br><span class="line">permutation = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># for _ in range(128):</span></span><br><span class="line"><span class="comment">#     permutation += &quot;127,&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">    permutation += <span class="built_in">str</span>((i-<span class="number">1</span>)%<span class="number">64</span>) + <span class="string">&quot;,&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>, <span class="number">128</span>):</span><br><span class="line">    permutation += <span class="built_in">str</span>(i) + <span class="string">&quot;,&quot;</span>    </span><br><span class="line"></span><br><span class="line">permutation = permutation[:-<span class="number">1</span>]</span><br><span class="line"><span class="comment"># print(permutation)</span></span><br><span class="line">p = [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> permutation.strip().split(<span class="string">&#x27;,&#x27;</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p = &quot;</span>,p)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;Permutation: &#x27;</span>, permutation.encode())</span><br><span class="line">enc2 = <span class="built_in">bytes</span>.fromhex(r.recvline_startswith(<span class="string">b&#x27;Here is the permuted password encrypted with another one-time pad:&#x27;</span>).decode().strip(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">67</span>:])</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(enc2) == <span class="number">256</span></span><br><span class="line"></span><br><span class="line">h3 = <span class="built_in">list</span>(enc2[:<span class="number">128</span>])</span><br><span class="line">h4 = <span class="built_in">list</span>(enc2[<span class="number">128</span>:])</span><br><span class="line"><span class="comment"># print(&quot;h3  = &quot;, h3)</span></span><br><span class="line"><span class="comment"># print(&quot;h4  = &quot;, h4)</span></span><br><span class="line">h34 = [h3[i] ^ h4[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h34 = &quot;</span>, h34)    <span class="comment">#   --&gt; Kết quả XOR nửa đầu P0(&gt;&gt;1) và nửa sau P1 của secret</span></span><br><span class="line"></span><br><span class="line">h1234 = [h12[i] ^ h34[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h1234 = &quot;</span>, h1234)    <span class="comment">#   --&gt; Kết quả XOR nửa đầu P0(&gt;&gt;1) và nửa đầu P0 của secret</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># đoán byte đầu tiên của P0</span></span><br><span class="line">guest = <span class="string">&quot;0123456789abcdef&quot;</span></span><br><span class="line">passwd1 = []</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> guest:</span><br><span class="line">    passwd1.clear()</span><br><span class="line">    passwd1.append(c)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">128</span>, <span class="number">2</span>):</span><br><span class="line">        ch = <span class="built_in">chr</span>(<span class="built_in">ord</span>(passwd1[j // <span class="number">2</span>]) ^ h1234[(<span class="number">2</span> + j) % <span class="number">128</span>])</span><br><span class="line">        <span class="keyword">if</span> ch <span class="keyword">in</span> guest:</span><br><span class="line">            passwd1.append(ch)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(passwd1) == <span class="number">65</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(passwd1)</span><br><span class="line">passwd2 = []</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> guest:</span><br><span class="line">    passwd2.clear()</span><br><span class="line">    passwd2.append(c)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">128</span>, <span class="number">2</span>):</span><br><span class="line">        ch = <span class="built_in">chr</span>(<span class="built_in">ord</span>(passwd2[j // <span class="number">2</span>]) ^ h1234[(<span class="number">2</span> + j) % <span class="number">128</span>])</span><br><span class="line">        <span class="keyword">if</span> ch <span class="keyword">in</span> guest:</span><br><span class="line">            passwd2.append(ch)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(passwd2) == <span class="number">65</span>):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(passwd2)</span><br><span class="line">password_h1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        password_h1.append(passwd1[i//<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        password_h1.append(passwd2[i//<span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(password_h1)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># --&gt; tính được nửa đầu P0, việc còn lại là tính nửa sau P1 dựa vào XOR h12</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">    password_h1.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(password_h1[i]) ^ h12[i]))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(password_h1))</span><br><span class="line"></span><br><span class="line"><span class="comment"># --&gt; Ghép P0 và P1 lại với nhau và submit đáp án</span></span><br><span class="line">password = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(password_h1)):</span><br><span class="line">    password += password_h1[i]</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&quot;What is my password: &quot;</span>, password.encode())</span><br><span class="line">flag = r.recvline().decode().strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kalmar&#123;why_do_default_args_work_like_that_0.0&#125;</span><br></pre></td></tr></table></figure>

<h2 id="EasyOneTimePad-100"><a href="#EasyOneTimePad-100" class="headerlink" title="EasyOneTimePad (100)"></a>EasyOneTimePad (100)</h2><blockquote>
<p>I fixed the mistake from last time, now it should be secure - right?<br><code>nc nc 3.120.132.103 13341</code></p>
</blockquote>
<p>Do bài phía mình đã giải quyết được bài toán tổng quát hơn, nên đối với bài toán nhỏ hơn này thì mình chỉ việc sử dụng lại code và lấy flag :))</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kalmar&#123;guess_i_should_have_read_the_whole_article&#125;</span><br></pre></td></tr></table></figure>

<p>Bài sau đây là bài mà mình vẫn chưa giải được, đợi write-up từ các Pro vậy :(</p>
<h2 id="DreamHash"><a href="#DreamHash" class="headerlink" title="DreamHash"></a>DreamHash</h2><blockquote>
<p>I fell asleep in my abstract algebra class and dreamt of this weird hash function, so I decided to make a challenge with it. Can you solve it?<br><code>nc &#123;Remote server IP and PORT&#125;</code></p>
</blockquote>
<figure class="highlight python"><figcaption><span>challenge.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &quot;DreamHash&quot; challenge for KalmarCTF 2023</span></span><br><span class="line"><span class="comment"># by shalaamum</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">VALUESIZE = <span class="number">216</span></span><br><span class="line">BLOCKSIZE = <span class="number">16</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Value</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(n, Value):</span><br><span class="line">            n = n.n</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (<span class="built_in">isinstance</span>(n, <span class="built_in">int</span>) <span class="keyword">and</span> <span class="number">0</span> &lt;= n &lt;= VALUESIZE):</span><br><span class="line">            <span class="keyword">raise</span> ValueError</span><br><span class="line">        self.n = n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> self.n == other.n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract</span>(<span class="params">self</span>):</span><br><span class="line">        a = self.n % <span class="number">3</span></span><br><span class="line">        b = ((self.n // <span class="number">27</span>) + <span class="number">1</span>) % <span class="number">3</span></span><br><span class="line">        c = (self.n // <span class="number">9</span>) % <span class="number">3</span></span><br><span class="line">        d = (((self.n // <span class="number">27</span>) + <span class="number">1</span>) // <span class="number">3</span>) % <span class="number">3</span></span><br><span class="line">        <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">            f = (self.n // <span class="number">3</span>) % <span class="number">3</span></span><br><span class="line">            e = (<span class="number">2</span> * d) % <span class="number">3</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            e = (self.n // <span class="number">3</span>) % <span class="number">3</span></span><br><span class="line">            f = ((<span class="number">1</span> + d*e) * b) % <span class="number">3</span></span><br><span class="line">        <span class="keyword">return</span> a,b,c,d,e,f</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">assemble</span>(<span class="params">cls, a, b, c, d, e, f</span>):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> (a,b,c,d,e,f):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (<span class="built_in">isinstance</span>(x, <span class="built_in">int</span>) <span class="keyword">and</span> <span class="number">0</span> &lt;= x &lt;= <span class="number">2</span>):</span><br><span class="line">                <span class="keyword">raise</span> ValueError</span><br><span class="line">        n = <span class="number">0</span></span><br><span class="line">        n += a</span><br><span class="line">        n += <span class="number">27</span> * ((b + <span class="number">3</span> * d) - <span class="number">1</span>)</span><br><span class="line">        n += <span class="number">9</span> * c</span><br><span class="line">        <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">            n += <span class="number">3</span> * f</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            n += <span class="number">3</span> * e</span><br><span class="line">        <span class="keyword">return</span> Value(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self, other</span>):</span><br><span class="line">        sa, sb, sc, sd, se, sf = self.extract()</span><br><span class="line">        oa, ob, oc, od, oe, of = other.extract()</span><br><span class="line">        a = (sa + sb * oa + sd * oc) % <span class="number">3</span></span><br><span class="line">        b = (sb * ob + sd * oe) % <span class="number">3</span></span><br><span class="line">        c = (sc + se * oa + sf * oc) % <span class="number">3</span></span><br><span class="line">        d = (sb * od + sd * of) % <span class="number">3</span></span><br><span class="line">        e = (se * ob + sf * oe) % <span class="number">3</span></span><br><span class="line">        f = (se * od + sf * of) % <span class="number">3</span></span><br><span class="line">        <span class="keyword">return</span> Value.assemble(a, b, c, d, e, f)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">str</span>(self.n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">repr</span>(self.n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DreamHash</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># I read that it is important to use nothing-up-my-sleeves-numbers for</span></span><br><span class="line">        <span class="comment"># constants in cryptosystems, so I generate the template randomly.</span></span><br><span class="line">        self.template = [</span><br><span class="line">                random.sample(</span><br><span class="line">                    <span class="built_in">sum</span>([[(i+j) % BLOCKSIZE]*(<span class="number">1</span> <span class="keyword">if</span> j == <span class="number">0</span> <span class="keyword">else</span> j*VALUESIZE)</span><br><span class="line">                         <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(BLOCKSIZE)], []),</span><br><span class="line">                    k=(<span class="number">1</span> + VALUESIZE * <span class="built_in">sum</span>(<span class="built_in">range</span>(BLOCKSIZE)))</span><br><span class="line">                    )</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(BLOCKSIZE)</span><br><span class="line">                ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">hash</span>(<span class="params">self, data</span>):</span><br><span class="line">        unfolded_data = [Value(d) <span class="keyword">for</span> d <span class="keyword">in</span> data]</span><br><span class="line">        unfolded_data += [Value(<span class="number">0</span>)] * (BLOCKSIZE - (<span class="built_in">len</span>(unfolded_data) % BLOCKSIZE))</span><br><span class="line">        folded_data = [<span class="built_in">sum</span>(unfolded_data[i::BLOCKSIZE], Value(<span class="number">0</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(BLOCKSIZE)]</span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(BLOCKSIZE):</span><br><span class="line">            result.append(Value(<span class="number">0</span>))</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> self.template[i]:</span><br><span class="line">                result[-<span class="number">1</span>] += folded_data[j]</span><br><span class="line">        <span class="keyword">return</span> [x.n <span class="keyword">for</span> x <span class="keyword">in</span> result]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Welcome to the DreamHash testing service.&#x27;</span>)</span><br><span class="line">    H = DreamHash()</span><br><span class="line">    secret = <span class="built_in">bytes</span>([random.randrange(VALUESIZE) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(BLOCKSIZE)])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;I generated a secret. Can you recover it?&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            user_bytes = base64.b64decode(<span class="built_in">input</span>(<span class="string">&#x27;Your values: &#x27;</span>))</span><br><span class="line">            h = H.<span class="built_in">hash</span>(secret + user_bytes)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Hash: <span class="subst">&#123;base64.b64encode(<span class="built_in">bytes</span>(h)).decode()&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">    user_bytes = base64.b64decode(<span class="built_in">input</span>(<span class="string">&#x27;Your guess at secret: &#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> user_bytes == secret:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="built_in">print</span>(f.read())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Wrong.\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>



<h2 id="Reconstruction-842"><a href="#Reconstruction-842" class="headerlink" title="Reconstruction (842)"></a>Reconstruction (842)</h2><blockquote>
<p>Shamir agreed to keep my flag secret for me in his stronghold. He assured me that the adversary would never cross its threshold. But the adversary commanded vast legions, and broke through to the threshold. There remains only one defense against reconstruction.<br>Note: This challenge requires some extended computation. Our (very unoptimised) solve script terminates in under <code>30 minutes</code> :)</p>
</blockquote>
<figure class="highlight python"><figcaption><span>chal.sage</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">rng = random.SystemRandom()</span><br><span class="line"></span><br><span class="line">num_parties = <span class="number">1000</span></span><br><span class="line">threshold = <span class="built_in">int</span>(<span class="number">0.1111</span> * num_parties)</span><br><span class="line">num_compromised = <span class="built_in">int</span>(<span class="number">0.37</span> * num_parties)</span><br><span class="line"></span><br><span class="line">prime = (<span class="number">2</span>**<span class="number">384</span>).next_prime()</span><br><span class="line">F = GF(prime)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Party</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, share</span>):</span><br><span class="line">        self.share = share</span><br><span class="line">        self.compromised = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compromise</span>(<span class="params">self</span>):</span><br><span class="line">        self.compromised = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_share</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.compromised:</span><br><span class="line">            <span class="keyword">return</span> self.share</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> F(rng.randrange(F.order()))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">share</span>(<span class="params">secret</span>):</span><br><span class="line">    R.&lt;x&gt; = F[<span class="string">&#x27;x&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    poly = secret * x**threshold</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(threshold):</span><br><span class="line">        poly += x**i * F(rng.randrange(F.order()))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [Party(poly(F(j))) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(num_parties)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        flag = f.read().strip()</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(flag) &lt; prime.nbits()*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Share the secret.</span></span><br><span class="line">    secret = F(<span class="built_in">int</span>.from_bytes(flag.encode(), <span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    parties = share(secret)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Oops, the adversary has compromised some of the parties!</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> rng.sample(<span class="built_in">range</span>(num_parties), num_compromised):</span><br><span class="line">        parties[i].compromise()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># The adversary is requesting the shares! All is lost!</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> parties:</span><br><span class="line">        <span class="built_in">print</span>(s.get_share())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>Tổng hợp những gì chúng ta đã biết:</p>
<ol>
<li>Số nguyên tố prime chọn là 385-bit, khả năng flag dài 48 ký tự;</li>
<li>Generated 1 đa thức <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>l</mi><mi>y</mi><mo>∈</mo><mi>G</mi><mi>F</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">poly\in GF(p)[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span> bậc 111, trong đó:<ul>
<li>Hệ số của <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>111</mn></msup></mrow><annotation encoding="application/x-tex">x^{111}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> là giá trị của flag chuyển sang int;</li>
<li>111 hệ số còn lại của <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>0</mn></msup><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msup><mi>x</mi><mn>110</mn></msup></mrow><annotation encoding="application/x-tex">x^{0}, \ldots, x^{110}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span> là những số ngẫu nhiên dài 384-bit;</li>
</ul>
</li>
<li>Trong 1000 dòng giá trị trong file output.txt:<ul>
<li>370 dòng là giá trị của đa thức poly tại giá trị <em>j</em>, tương ứng với index của dòng;</li>
<li>630 dòng còn lại là những giá trị ngẫu nhiên;</li>
</ul>
</li>
</ol>
<p>Ý tưởng làm bài này của mình như sau:</p>
<ol>
<li>Chọn 112 cặp giá trị khả năng <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>j</mi><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>j</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">;</mo><mtext>  </mtext><mi>i</mi><mo>∈</mo><mover accent="true"><mrow><mn>0</mn><mo separator="true">,</mo><mn>112</mn></mrow><mo stretchy="true">‾</mo></mover><mo separator="true">,</mo><mtext> </mtext><mi>j</mi><mo>∈</mo><mover accent="true"><mrow><mn>0</mn><mo separator="true">,</mo><mn>999</mn></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">(a_{i},b_{i})=(j,f(j));\;i\in\overline{0,112},\,j\in\overline{0,999}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mclose">)</span><span class="mclose">)</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0388800000000002em;vertical-align:-0.19444em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8444400000000002em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">2</span></span></span><span style="top:-3.76444em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0388800000000002em;vertical-align:-0.19444em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8444400000000002em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">9</span><span class="mord">9</span><span class="mord">9</span></span></span><span style="top:-3.76444em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>.</li>
<li>Sử dụng công thức đa nội suy Lagrange để tìm polynomial <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>∈</mo><mi>G</mi><mi>F</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">f\in GF(p)[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span> thỏa mãn điều kiện</li>
</ol>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub><mtext>  </mtext><mi mathvariant="normal">∀</mi><mtext> </mtext><mi>i</mi><mo>∈</mo><mover accent="true"><mrow><mn>0</mn><mo separator="true">,</mo><mn>112</mn></mrow><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex"> 
f(a_{i})=b_{i}\;\forall\,i\in\overline{0,112}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">∀</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0388800000000002em;vertical-align:-0.19444em;"></span><span class="mord overline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8444400000000002em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">2</span></span></span><span style="top:-3.76444em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span></span>

<ol start="3">
<li>Kiểm tra polynomial thu được bậc bằng 111 hay không? Nếu có, kiểm tra xem hệ số <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>111</mn></msup></mrow><annotation encoding="application/x-tex">x^{111}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> có phải là biểu diễn của flag hay không? Nếu có, đưa kết quả ra màn hình và kết thúc chương trình, nếu không thì quay lại bước 1.</li>
</ol>
<p>Xác suất của cách làm này bằng</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mn>370</mn><mn>112</mn></mfrac><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mfrac linethickness="0px"><mn>1000</mn><mn>112</mn></mfrac><mo fence="true">)</mo></mrow></mfrac><mo>=</mo><mfrac><mfrac><mrow><mn>370</mn><mo stretchy="false">!</mo></mrow><mrow><mn>112</mn><mo stretchy="false">!</mo><mn>258</mn><mo stretchy="false">!</mo></mrow></mfrac><mfrac><mrow><mn>1000</mn><mo stretchy="false">!</mo></mrow><mrow><mn>112</mn><mo stretchy="false">!</mo><mn>888</mn><mo stretchy="false">!</mo></mrow></mfrac></mfrac><mo>=</mo><mfrac><mrow><mn>888</mn><mo stretchy="false">!</mo><mo>×</mo><mn>370</mn><mo stretchy="false">!</mo></mrow><mrow><mn>1000</mn><mo stretchy="false">!</mo><mo>×</mo><mn>258</mn><mo stretchy="false">!</mo></mrow></mfrac><mo>=</mo><mfrac><mrow><mn>259</mn><mo>×</mo><mo>…</mo><mo>×</mo><mn>370</mn></mrow><mrow><mn>889</mn><mo>×</mo><mo>…</mo><mo>×</mo><mn>1000</mn></mrow></mfrac><mo>&lt;</mo><msup><mrow><mo fence="true">(</mo><mn>0</mn><mo separator="true">,</mo><mn>37</mn><mo fence="true">)</mo></mrow><mn>112</mn></msup><mo>≈</mo><mn>0</mn></mrow><annotation encoding="application/x-tex"> 
\frac{\binom{370}{112}}{\binom{1000}{112}}=\frac{\frac{370!}{112!258!}}{\frac{1000!}{112!888!}}=\frac{888!\times370!}{1000!\times258!}=\frac{259\times\ldots\times370}{889\times\ldots\times1000}&lt;\left(0,37\right)^{112}\approx0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.7702359999999997em;vertical-align:-1.1351179999999998em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6351179999999998em;"><span style="top:-2.2148920000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8951079999999999em;"><span style="top:-2.3550000000000004em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7400100000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8951079999999999em;"><span style="top:-2.3550000000000004em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span><span style="top:-3.144em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">7</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1351179999999998em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.7302159999999995em;vertical-align:-1.1151079999999998em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6151079999999998em;"><span style="top:-2.2298920000000004em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">2</span><span class="mclose mtight">!</span><span class="mord mtight">8</span><span class="mord mtight">8</span><span class="mord mtight">8</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mclose mtight">!</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.7350000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">2</span><span class="mclose mtight">!</span><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">8</span><span class="mclose mtight">!</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">7</span><span class="mord mtight">0</span><span class="mclose mtight">!</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1151079999999998em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.14077em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord">8</span><span class="mclose">!</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span><span class="mord">8</span><span class="mord">8</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord">7</span><span class="mord">0</span><span class="mclose">!</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.09077em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span><span class="mord">8</span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord">5</span><span class="mord">9</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord">7</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.204008em;vertical-align:-0.25em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mord">7</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span>

<p>rất nhỏ :(( Tuy nhiên mình vẫn chưa nghĩ ra phương án loại đi những số ngẫu nhiên. Đợi có write-up tham khảo sau vậy.</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Kalmar CTF 2023 Write-ups</p><p><a href="https://pinox0x0.github.io/2023/kalmar-ctf-2023-write-ups/">https://pinox0x0.github.io/2023/kalmar-ctf-2023-write-ups/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Pinox0x0</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2023-03-06</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-03-25</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/crypto/">crypto</a><a class="link-muted mr-2" rel="tag" href="/tags/CTF/">CTF</a><a class="link-muted mr-2" rel="tag" href="/tags/WriteUp/">WriteUp</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/pragyan-ctf-2023-write-ups/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Pragyan CTF 2023 Write-ups</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/la-ctf-2023-write-ups/"><span class="level-item">LA CTF 2023 Write-ups</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Pinox0x0"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Pinox0x0</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">2</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">4</p></a></div></div></nav></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Misc"><span class="level-left"><span class="level-item">1</span><span class="level-item">Misc</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Sanity-Check-100"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Sanity Check (100)</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Forensic"><span class="level-left"><span class="level-item">2</span><span class="level-item">Forensic</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#sewing-waste-and-agriculture-leftovers-100"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">sewing-waste-and-agriculture-leftovers (100)</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Crypto"><span class="level-left"><span class="level-item">3</span><span class="level-item">Crypto</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#BabyOneTimePad-100"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">BabyOneTimePad (100)</span></span></a></li><li><a class="level is-mobile" href="#EasyOneTimePad-100"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">EasyOneTimePad (100)</span></span></a></li><li><a class="level is-mobile" href="#DreamHash"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">DreamHash</span></span></a></li><li><a class="level is-mobile" href="#Reconstruction-842"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">Reconstruction (842)</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Pinox0x0&#039;s Blog</a><p class="is-size-7"><span>&copy; 2023 Pinox0x0</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2023 Pinox0x0</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>
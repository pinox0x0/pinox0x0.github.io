<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Pragyan CTF 2023 Write-ups - Pinox&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Pinox&#039;s Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Pinox&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Là mình pinox đây, giải Pragyan và giải Kalmar tổ chức ngay sau nhau, tuy nhiên giải này vào đầu tuần nên mình có ít thời gian để tham gia vì còn bận đi học :(("><meta property="og:type" content="blog"><meta property="og:title" content="Pragyan CTF 2023 Write-ups"><meta property="og:url" content="https://pinox0x0.github.io/2023/pragyan-ctf-2023-write-ups/"><meta property="og:site_name" content="Pinox&#039;s Blog"><meta property="og:description" content="Là mình pinox đây, giải Pragyan và giải Kalmar tổ chức ngay sau nhau, tuy nhiên giải này vào đầu tuần nên mình có ít thời gian để tham gia vì còn bận đi học :(("><meta property="og:locale" content="en_US"><meta property="og:image" content="https://pinox0x0.github.io/src/2023/Pragyan-CTF-2023/pragyan-ctf-2023-result.jpg"><meta property="og:image" content="https://pinox0x0.github.io/src/2023/Pragyan-CTF-2023/broken-hash-1.jpg"><meta property="og:image" content="https://pinox0x0.github.io/src/2023/Pragyan-CTF-2023/broken-hash.png"><meta property="article:published_time" content="2023-03-08T09:00:00.000Z"><meta property="article:modified_time" content="2023-03-24T22:01:30.258Z"><meta property="article:author" content="Pinox0x0"><meta property="article:tag" content="crypto"><meta property="article:tag" content="CTF"><meta property="article:tag" content="WriteUp"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://pinox0x0.github.io/src/2023/Pragyan-CTF-2023/pragyan-ctf-2023-result.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://pinox0x0.github.io/2023/pragyan-ctf-2023-write-ups/"},"headline":"Pragyan CTF 2023 Write-ups","image":["https://pinox0x0.github.io/src/2023/Pragyan-CTF-2023/pragyan-ctf-2023-result.jpg","https://pinox0x0.github.io/src/2023/Pragyan-CTF-2023/broken-hash-1.jpg","https://pinox0x0.github.io/src/2023/Pragyan-CTF-2023/broken-hash.png"],"datePublished":"2023-03-08T09:00:00.000Z","dateModified":"2023-03-24T22:01:30.258Z","author":{"@type":"Person","name":"Pinox0x0"},"publisher":{"@type":"Organization","name":"Pinox's Blog","logo":{"@type":"ImageObject","url":{"text":"Pinox0x0's Blog"}}},"description":"Là mình pinox đây, giải Pragyan và giải Kalmar tổ chức ngay sau nhau, tuy nhiên giải này vào đầu tuần nên mình có ít thời gian để tham gia vì còn bận đi học :(("}</script><link rel="canonical" href="https://pinox0x0.github.io/2023/pragyan-ctf-2023-write-ups/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Pinox0x0&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/tools">Tools</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2023-03-08T09:00:00.000Z" title="12:00:00 8/3/2023">2023-03-08</time></span><span class="level-item">Updated&nbsp;<time dateTime="2023-03-24T22:01:30.258Z" title="01:01:30 25/3/2023">2023-03-25</time></span><span class="level-item"><a class="link-muted" href="/categories/CTF-Write-ups/">CTF Write-ups</a></span><span class="level-item">an hour read (About 12476 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Pragyan CTF 2023 Write-ups</h1><div class="content"><p><img src="/src/2023/Pragyan-CTF-2023/pragyan-ctf-2023-result.jpg"></p>
<p>Là mình pinox đây, giải Pragyan và giải Kalmar tổ chức ngay sau nhau, tuy nhiên giải này vào đầu tuần nên mình có ít thời gian để tham gia vì còn bận đi học :(( </p>
<span id="more"></span>

<p>Tổng kết thì mình làm được 1 bài duy nhất là LeakyRSA, còn 2 bài Compromised và CustomAESed thì mình đã giải được một phần, khúc cuối mình không hiểu dữ kiện nên không làm tiếp được, chắc sẽ phải tham gia nhiều hơn để học hỏi kinh nghiệm. :(( </p>
<h2 id="Sanity-Check-10"><a href="#Sanity-Check-10" class="headerlink" title="Sanity Check (10)"></a>Sanity Check (10)</h2><blockquote>
<p>Read the rules for Pragyan CTF 2023 in our <a target="_blank" rel="noopener" href="https://discord.gg/rnpEZTseG6">discord server</a> for the flag</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p_ctf&#123;pl34s3_f0ll0w_th3_rul3s&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Leaky-RSA-451"><a href="#Leaky-RSA-451" class="headerlink" title="Leaky RSA (451)"></a>Leaky RSA (451)</h2><blockquote>
<p>XOR-ing the two most important numbers for RSA will give you the XOR key.<br>Files: <code>cipher.txt</code>, <code>keys.txt</code></p>
</blockquote>
<figure class="highlight text"><figcaption><span>cipher.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">03cbfb27971838e83245ff0ee4340491f81319c9c5122289f287c6439946de361e5b5a40bb25798ed0139a172f1003e0f4fd663ac2469b9706b29c267add203d3ddde4388d5633af534dba0ef838069bab465b9580567bc8aedf921688559e675c191c1ef8716a9e974bdf4f3f555ab4e4ab3a6a9457c8c250edde726a887e6e7e94a47cd40865b06811ef4dba6951cfa647089480577ac8afdf931788559f665d181d1ef9706b9e974adf4e3e545ab5e5ab3a6a9456c9c250ecde726a887f6e7f94a57dd50865b06810ef4dba6951cea646089481577ac8afde931689549f665d181c1ff9706a9f964bdf4e3e555ab4e4aa3b6a9556c9c251ecdf726b887f6f7e95a57cd40964b06810ef4cbb6950cea646099581577bc9aedf921789559f675d181d1ef9716a9e964ade4f3e545bb5e4aa3b6a9456c9c351ecde726a897e6e7f95a47dd50965b16911ee4cba6850cfa647089480567bc8afdf921789549f675d191d1ef9716a9e974bde4f3f545bb4e5aa3b6b9456c8c351ecdf726b887f6f7e94a47dd50865b16911ee4cba6850cfa747089580577bc9afdf931689559e665c181d1ff9706b9f964ade4e3f545bb4e5ab3b6b9457c8c250ecde736b887f6e7e95a57cd40965b16911ef4dbb6950cea747089580577ac9aedf921788549f665c181c1ff8716b9f974adf4e3e545ab4e5aa3b6b9557c9c351ecdf726a887e6e7e94a57dd50864b16910ef4dba6851cea746089580577ac9afdf931789559f665c191c1ff8706b9f964bdf4f3f545ab4e4ab3a6a9556c8c251ecde736b887f6e7f95a47cd50864b06911ee4dba6950cea747099580567bc9aede931689549f665c191c1ff8706a9f974ade4f3f545ab4e4aa3b6b9557c8c250edde726a897e6e7e94a57dd50865b16911ef4cba6851cea747089581577ac9afdf931688559f665d181c1ef8706a9e964adf4f3f555bb4e4aa3b6a9556c8c250ecde726b887e6f7e94a47dd40965b16811ee4dba6851cfa647099580567ac8aedf921788559f665d181c1ff9716b9f974ade4e3e555ab4e5aa3b6a9556c9c350edde726b887f6e7f94a57cd50965b16910ef4cbb6950cfa646099480567bc8afde921689549e665d181c1ef9716b9e974bdf4e3f555ab4e5aa3b6b9456c8c350ecdf736b897e6e7f94a47cd50865b16810ee4cbb6851cea647089580577bc8afde931789549f675d181d1ff9706b9e974bde4e3f545bb5e4ab3b6a9556c9c251edde736a887f6f7f94a57cd40965b06910ef4cbb6850cea646089481577bc9afdf931788559e675d181d1ef8706b9f964ade4e3f545ab5e4ab3a6b9457c8c350edde726b897e6f7e95a47cd40864b06810ef4dba6951cfa747089581577bc8afdf921788559e675c191c1ef8706b9f974bde4f3f555ab5e4ab3a6a9456c9c351ecde736b887e6e7f94a47cd40864b06910ee4cba6950cea647099480567bc8afdf931688549e675d181d1ff8716b9f964bde4f3e545ab5e4ab3a6a9456c9c251ecde726a887e6f7f95a57dd40965b06910ef4cbb6950cfa747</span><br></pre></td></tr></table></figure>

<figure class="highlight text"><figcaption><span>keys.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">n=90622785163120637260087015941572725098110139248382612878945571071101519512487568042232671567664172893228075756497045498977699900942323326164843993553269528291618632246672608219867461615864060915805942735237995404948413293503561184020274098566470196075252508233670564868845603564225996537006792676270111655183</span><br><span class="line">e=65537</span><br><span class="line">d=15881146338685635884036488977050563006420723396976888000895522891673420382393452842898549414141981257590741871971078437459128177400896949829916432945653604999697231535449287553706229377750925398422163407130833254874911822837377080596876193928404120093555522404504384602474224038479487948631716643357270128113</span><br></pre></td></tr></table></figure>

<p>Dựa vào gợi ý của đề bài, đầu tiên ta đi tìm 2 số p, q khi biết n, e, d (thuật toán trình bày ở <a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/16122/rsa-finding-p-q">đây</a>). Sau khi tìm được 2 số p, q thỏa mãn, ta tìm được <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>o</mi><mi>r</mi><mi mathvariant="normal">_</mi><mi>k</mi><mi>e</mi><mi>y</mi><mo>=</mo><mi>q</mi><mo>⊕</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">xor\_key = q \oplus p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00444em;vertical-align:-0.31em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span>. Sử dụng <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>o</mi><mi>r</mi><mi mathvariant="normal">_</mi><mi>k</mi><mi>e</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">xor\_key</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00444em;vertical-align:-0.31em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> vừa thu được, ta giải mã file <code>ciphers.txt</code> bằng cách XOR và thu được plain</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Looks like someone mutiplied &quot;password&quot; with the flag before encrypting.</span><br><span class="line">message=0b100010111110011111010011001110001111000010000100000111100100101100111110011110001010000111010100110000101001000111011100010000010111110010011001001111111111101110000111110111110010110010010000111000110011000010010100010000111100111010100010111100111111101100001111000100101001001000001111010111111101110011010011111111111010011010101100001011001000110101110010010101110011001000010111101100110101110101001001110111110010111110000101110000000110010110110110001111110110111100011000100101100101001001001011010101101000000010011111011110000001101100110000101001011101001011100111111101101111100111110101001010111001001011001100101101110110101010011011011110010000100011111111100010001101000101110000100110000000110110001001100000111011111101011011011000000101010110100011101011000001000000100010100000011000010000011001001110001011000101100110011000001110110010010000011110001110111000001100010011111110111101100111111010100011000011001110010000000000100111010010000011101100000001001110010100001100011010001011101110001001111</span><br></pre></td></tr></table></figure>

<p>Đến đây thì mình bắt đầu suy nghĩ về dữ kiện mới :)), và về cipher RSA chưa sử dụng, sau nhiều lần thử thì mình đi đến kết luận rằng , ở đây  là giá trị của “password” -&gt; hex -&gt; int :)). Còn lại là giải bình thường thôi.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line">n=<span class="number">90622785163120637260087015941572725098110139248382612878945571071101519512487568042232671567664172893228075756497045498977699900942323326164843993553269528291618632246672608219867461615864060915805942735237995404948413293503561184020274098566470196075252508233670564868845603564225996537006792676270111655183</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=<span class="number">15881146338685635884036488977050563006420723396976888000895522891673420382393452842898549414141981257590741871971078437459128177400896949829916432945653604999697231535449287553706229377750925398422163407130833254874911822837377080596876193928404120093555522404504384602474224038479487948631716643357270128113</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">8090579019548651740169774893471409762905415187922576361313273217727161034444882205917051180880965304736581653032799951601902931351004322273094375585996887</span></span><br><span class="line">q = <span class="number">11201025902368134933491342445834514167593639050571204653767361996077157225761247125637197847363122890891214577057215402210559002072464380051697200976473609</span></span><br><span class="line"></span><br><span class="line">xor_key = p ^ q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;xor_key = &quot;</span>, <span class="built_in">hex</span>(xor_key)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">msg1 = <span class="string">&quot;03cbfb27971838e83245ff0ee4340491f81319c9c5122289f287c6439946de361e5b5a40bb25798ed0139a172f1003e0f4fd663ac2469b9706b29c267add203d3ddde4388d5633af534dba0ef838069bab465b9580567bc8aedf921688559e675c191c1ef8716a9e974bdf4f3f555ab4e4ab3a6a9457c8c250edde726a887e6e7e94a47cd40865b06811ef4dba6951cfa647089480577ac8afdf931788559f665d181d1ef9706b9e974adf4e3e545ab5e5ab3a6a9456c9c250ecde726a887f6e7f94a57dd50865b06810ef4dba6951cea646089481577ac8afde931689549f665d181c1ff9706a9f964bdf4e3e555ab4e4aa3b6a9556c9c251ecdf726b887f6f7e95a57cd40964b06810ef4cbb6950cea646099581577bc9aedf921789559f675d181d1ef9716a9e964ade4f3e545bb5e4aa3b6a9456c9c351ecde726a897e6e7f95a47dd50965b16911ee4cba6850cfa647089480567bc8afdf921789549f675d191d1ef9716a9e974bde4f3f545bb4e5aa3b6b9456c8c351ecdf726b887f6f7e94a47dd50865b16911ee4cba6850cfa747089580577bc9afdf931689559e665c181d1ff9706b9f964ade4e3f545bb4e5ab3b6b9457c8c250ecde736b887f6e7e95a57cd40965b16911ef4dbb6950cea747089580577ac9aedf921788549f665c181c1ff8716b9f974adf4e3e545ab4e5aa3b6b9557c9c351ecdf726a887e6e&quot;</span></span><br><span class="line">msg2 = <span class="string">&quot;7e94a57dd50864b16910ef4dba6851cea746089580577ac9afdf931789559f665c191c1ff8706b9f964bdf4f3f545ab4e4ab3a6a9556c8c251ecde736b887f6e7f95a47cd50864b06911ee4dba6950cea747099580567bc9aede931689549f665c191c1ff8706a9f974ade4f3f545ab4e4aa3b6b9557c8c250edde726a897e6e7e94a57dd50865b16911ef4cba6851cea747089581577ac9afdf931688559f665d181c1ef8706a9e964adf4f3f555bb4e4aa3b6a9556c8c250ecde726b887e6f7e94a47dd40965b16811ee4dba6851cfa647099580567ac8aedf921788559f665d181c1ff9716b9f974ade4e3e555ab4e5aa3b6a9556c9c350edde726b887f6e7f94a57cd50965b16910ef4cbb6950cfa646099480567bc8afde921689549e665d181c1ef9716b9e974bdf4e3f555ab4e5aa3b6b9456c8c350ecdf736b897e6e7f94a47cd50865b16810ee4cbb6851cea647089580577bc8afde931789549f675d181d1ff9706b9e974bde4e3f545bb5e4ab3b6a9556c9c251edde736a887f6f7f94a57cd40965b06910ef4cbb6850cea646089481577bc9afdf931788559e675d181d1ef8706b9f964ade4e3f545ab5e4ab3a6b9457c8c350edde726b897e6f7e95a47cd40864b06810ef4dba6951cfa747089581577bc8afdf921788559e675c191c1ef8706b9f974bde4f3f555ab5e4ab3a6a9456c9c351ecde736b887e6e&quot;</span></span><br><span class="line">msg3 = <span class="string">&quot;7f94a47cd40864b06910ee4cba6950cea647099480567bc8afdf931688549e675d181d1ff8716b9f964bde4f3e545ab5e4ab3a6a9456c9c251ecde726a887e6f7f95a57dd40965b06910ef4cbb6950cfa747&quot;</span></span><br><span class="line">pt = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(msg1),<span class="number">128</span>):</span><br><span class="line">    num = <span class="built_in">int</span>(msg1[i: i+<span class="number">128</span>],<span class="number">16</span>)</span><br><span class="line">    res = num ^ xor_key</span><br><span class="line">    pt += <span class="built_in">hex</span>(res)[<span class="number">2</span>:]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(msg2),<span class="number">128</span>):</span><br><span class="line">    num = <span class="built_in">int</span>(msg2[i: i+<span class="number">128</span>],<span class="number">16</span>)</span><br><span class="line">    res = num ^ xor_key</span><br><span class="line">    pt += <span class="built_in">hex</span>(res)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">t1 = <span class="built_in">int</span>(msg3[:<span class="number">128</span>], <span class="number">16</span>)</span><br><span class="line">pt += <span class="built_in">hex</span>(t1 ^ xor_key)[<span class="number">2</span>:]</span><br><span class="line">t2 = <span class="built_in">hex</span>(xor_key)[<span class="number">2</span>:]</span><br><span class="line">pt += <span class="built_in">hex</span>(<span class="built_in">int</span>(msg3[<span class="number">128</span>:], <span class="number">16</span>) ^ <span class="built_in">int</span>(t2[:<span class="number">36</span>],<span class="number">16</span>))[<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(pt).decode())</span><br><span class="line"></span><br><span class="line">message=<span class="number">0b100010111110011111010011001110001111000010000100000111100100101100111110011110001010000111010100110000101001000111011100010000010111110010011001001111111111101110000111110111110010110010010000111000110011000010010100010000111100111010100010111100111111101100001111000100101001001000001111010111111101110011010011111111111010011010101100001011001000110101110010010101110011001000010111101100110101110101001001110111110010111110000101110000000110010110110110001111110110111100011000100101100101001001001011010101101000000010011111011110000001101100110000101001011101001011100111111101101111100111110101001010111001001011001100101101110110101010011011011110010000100011111111100010001101000101110000100110000000110110001001100000111011111101011011011000000101010110100011101011000001000000100010100000011000010000011001001110001011000101100110011000001110110010010000011110001110111000001100010011111110111101100111111010100011000011001110010000000000100111010010000011101100000001001110010100001100011010001011101110001001111</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;message = msg4 = &quot;</span>, <span class="built_in">hex</span>(message)[<span class="number">2</span>:])</span><br><span class="line">msg4 = <span class="built_in">hex</span>(message)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">m = msg4</span><br><span class="line"></span><br><span class="line">mm = <span class="built_in">pow</span>(<span class="built_in">int</span>(m,<span class="number">16</span>),d,n)</span><br><span class="line">pas = <span class="built_in">int</span>(<span class="string">&quot;70617373776f7264&quot;</span>,<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(mm // pas)[<span class="number">2</span>:]).decode())</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p_ctf&#123;0n3_1eak_15_en0u6h_70_4774ck_rsa&#125;</span><br></pre></td></tr></table></figure>

<p>Những bài dưới đây có bài mình làm được một phần, một bài mình không làm được. <strong>Sau giờ kết thúc</strong> thì với một vài hint đến từ người chơi trong <strong>server discord Pragyan CTF 2023</strong>, mình đã từng bước làm được và trình bày cách làm dưới đây.</p>
<h2 id="CustomAESed-500"><a href="#CustomAESed-500" class="headerlink" title="CustomAESed (500)"></a>CustomAESed (500)</h2><blockquote>
<p>Alice wanted a method to secure data that not only encrypts but also provides error correction capabilities to some extent.<br>Help Bob read Alice’s message using encryption algorithm. Do not forget to wrap the flag in flag format<br>flag format: p_ctf{…}<br>Hint 1: Try relating the encoding function with what is given in the question.<br>Hint 2: If you are stuck at some point and can’t figure out how to proceed, google might be your best friend.<br>File: <code>encrypt.py</code></p>
</blockquote>
<figure class="highlight python"><figcaption><span>encrypt.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encryption</span>(<span class="params">text, key, iv</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(iv) == <span class="number">12</span></span><br><span class="line">    block_size = AES.block_size</span><br><span class="line">    text = pad(text, block_size)</span><br><span class="line">    encrypted = <span class="built_in">bytes</span>()</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, (<span class="built_in">len</span>(text) // block_size) + <span class="number">1</span>):</span><br><span class="line">        num = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;&#123;0:08x&#125;&quot;</span>.<span class="built_in">format</span>(n))</span><br><span class="line">        pt = iv[:<span class="number">8</span>] + num + iv[<span class="number">8</span>:]</span><br><span class="line">        ct = cipher.encrypt(pt)</span><br><span class="line">        encrypted += xor(text[(n - <span class="number">1</span>) * block_size: n * block_size], ct)</span><br><span class="line">    <span class="keyword">return</span> encrypted</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data_encoder</span>(<span class="params">text</span>):</span><br><span class="line">    bin_text = <span class="built_in">bin</span>(bytes_to_long(text))[<span class="number">2</span>:]</span><br><span class="line">    encoded_text = []</span><br><span class="line">    parity_bits = <span class="number">0</span></span><br><span class="line">    x = <span class="number">1</span></span><br><span class="line">    y = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> y &lt; <span class="built_in">len</span>(bin_text):</span><br><span class="line">        <span class="keyword">if</span> x &amp; (x - <span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">            encoded_text.append(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            parity_bits += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            encoded_text.append(bin_text[y])</span><br><span class="line">            y += <span class="number">1</span></span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(parity_bits):</span><br><span class="line">        pos_bit = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(encoded_text) + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> bit &amp; (<span class="number">2</span> ** x):</span><br><span class="line">                pos_bit ^= <span class="built_in">int</span>(encoded_text[bit - <span class="number">1</span>])</span><br><span class="line">        encoded_text[(<span class="number">2</span> ** x) - <span class="number">1</span>] = <span class="built_in">str</span>(pos_bit)</span><br><span class="line">    <span class="keyword">return</span> (<span class="string">&quot;&quot;</span>.join(encoded_text)).encode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pt = <span class="string">r&quot;--REDACTED--&quot;</span></span><br><span class="line">text = data_encoder(pt.encode())</span><br><span class="line"><span class="built_in">print</span>(text.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line">key = sha256(<span class="string">&quot;128bit_secretkey&quot;</span>.encode()).digest()</span><br><span class="line">iv = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;1670dc9a0ed463028e1a7d68&quot;</span>)</span><br><span class="line">ct = encryption(text, key, iv)</span><br><span class="line">ct = iv + ct</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ct = <span class="subst">&#123;b64encode(ct).decode()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ct = 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</span></span><br></pre></td></tr></table></figure>

<p>Những dữ kiện mà ta đã biết ban đầu là <code>key</code>, <code>iv</code>, <code>ct</code>, những dữ kiện này đã đủ để ta tìm lại <code>encoded_pt</code> ban đầu. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decryption</span>(<span class="params">ct, key, iv</span>):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(iv) == <span class="number">12</span></span><br><span class="line">    block_size = AES.block_size</span><br><span class="line">    decrypted = <span class="built_in">bytes</span>()</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, (<span class="built_in">len</span>(ct) // block_size) + <span class="number">1</span>):</span><br><span class="line">        num = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;&#123;0:08x&#125;&quot;</span>.<span class="built_in">format</span>(n))</span><br><span class="line">        _pt = iv[:<span class="number">8</span>] + num + iv[<span class="number">8</span>:]</span><br><span class="line">        _ct = cipher.encrypt(_pt)</span><br><span class="line">        decrypted += xor(ct[(n - <span class="number">1</span>) * block_size: n * block_size], _ct)</span><br><span class="line">    <span class="keyword">return</span> unpad(decrypted, AES.block_size)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">data_decoder</span>(<span class="params">text</span>):</span><br><span class="line">    bin_text = text.decode()</span><br><span class="line">    decoded_text = []</span><br><span class="line">    x = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> x &lt; <span class="built_in">len</span>(bin_text):</span><br><span class="line">        <span class="keyword">if</span> x &amp; (x - <span class="number">1</span>) != <span class="number">0</span>:</span><br><span class="line">            decoded_text.append(bin_text[x-<span class="number">1</span>])</span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;decoded_bin = &quot;</span>, <span class="string">&quot;&quot;</span>.join(decoded_text))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>((<span class="string">&quot;&quot;</span>.join(decoded_text)),<span class="number">2</span>))[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">key = sha256(<span class="string">&quot;128bit_secretkey&quot;</span>.encode()).digest()</span><br><span class="line">iv = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;1670dc9a0ed463028e1a7d68&quot;</span>)</span><br><span class="line">ct = b64decode(<span class="string">&quot;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&quot;</span>.encode()).<span class="built_in">hex</span>()</span><br><span class="line"><span class="keyword">assert</span> iv.<span class="built_in">hex</span>() == ct[:<span class="number">24</span>]</span><br><span class="line">ct = <span class="built_in">bytes</span>.fromhex(ct[<span class="number">24</span>:])</span><br><span class="line"><span class="comment"># print(&quot;iv = &quot;, iv)</span></span><br><span class="line"><span class="comment"># print(&quot;ct = &quot;, ct)</span></span><br><span class="line"></span><br><span class="line">pt = decryption(ct, key, iv)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;pt = &quot;</span>, pt)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pt =  b&#x27;0011110000001011111101100011011110100011001100111101101110100010101000011010010111001101011111011010010111001101011111011011100011011110111010001011111011101000110100001100101010111110110011001101100011000010110011101111101000010100000101000001010000010101000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101001010101011100110110010100100000010001010111011001100001011100100110100101110011011101000110010100100111011100110010000001101000011001010110110001110000001000000110000101100110011101000110010101110010001000000111011001101001011100110110100101110100011010010110111001100111001000000111010001101000011001010010000001100011011011110110110001101111011100110111001110110010101110101011011010010000001100110011011110111001000100000011010010111011000100000011101000110111100100000011001010110111001100011011100100111100101110000011101000010000001110100011010000110010100100000011100000110110001100001011010010110111001110100011001010111100001110100001000000111010101110011011010010110111001100111001000000111001101100001011011010110010100100000011010110110010101111000001000000110000101101110011001000010000001101001011101100011110100100111011001110110010000110011011001100110010101100011011000100011011001100111011001100011000100110101011000110110010001100101001110000011011000110111001110010110001000110110011001000011101001100101001001110010111000100000010001110110100101110110011001010010000001110100011010000110010100100000011000010111010101110100011010000110010101101110011101000110100101100011011000010111010001101001011011110110111000100000011000110110111101100100011001010010000001100001011100110010000001100110011011000110000101100111001000000110000101100110011101000110010101110101000100000011001010110111001100011011011110110010001101001011011100110011100100000001010000110001001100001011100110110010100110110001101000010100100100000011010010111010000101110&#x27;</span><br><span class="line">decoded_bin =  111000001011111011000110111010001100110011110110111010001101000011010010111001101011111011010010111001101011111011011100110111101110100010111110111010001101000011001010101111101100110011011000110000101100111011111010000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101001010101011100110110010100100000010001010111011001100001011100100110100101110011011101000110010100100111011100110010000001101000011001010110110001110000001000000110000101100110011101000110010101110010001000000111011001101001011100110110100101110100011010010110111001100111001000000111010001101000011001010010000001100011011011110110110001101111011100110111001101100101011101010110110100100000011001100110111101110010001000000110100101110110001000000111010001101111001000000110010101101110011000110111001001111001011100000111010000100000011101000110100001100101001000000111000001101100011000010110100101101110011101000110010101111000011101000010000001110101011100110110100101101110011001110010000001110011011000010110110101100101001000000110101101100101011110000010000001100001011011100110010000100000011010010111011000111101001001110110011101100100001100110110011001100101011000110110001000110110011001110110011000110001001101010110001101100100011001010011100000110110001101110011100101100010001101100110010000111010011001010010011100101110001000000100011101101001011101100110010100100000011101000110100001100101001000000110000101110101011101000110100001100101011011100111010001101001011000110110000101110100011010010110111101101110001000000110001101101111011001000110010100100000011000010111001100100000011001100110110001100001011001110010000001100001011001100111010001100101011100100010000001100101011011100110001101101111011001000110100101101110011001110010000000101000011000100110000101110011011001010011011000110100001010010010000001101001011101000010111</span><br><span class="line">decoded_str =  b&#x27;8/\xb1\xba3=\xba44\xb9\xaf\xb4\xb9\xaf\xb77\xba/\xba42\xaf\xb360\xb3\xbe\x85\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05\x05*\xb9\xb2\x90&quot;\xbb0\xb94\xb9\xba2\x93\xb9\x9042\xb68\x100\xb3:2\xb9\x10;4\xb9\xb4\xba4\xb73\x90:42\x901\xb7\xb67\xb9\xb9\xb2\xba\xb6\x9037\xb9\x104\xbb\x10:7\x902\xb71\xb9&lt;\xb8:\x10:42\x90860\xb4\xb7:2\xbc:\x10:\xb9\xb4\xb73\x909\xb0\xb6\xb2\x905\xb2\xbc\x100\xb72\x104\xbb\x1e\x93\xb3\xb2\x19\xb32\xb1\xb1\x1b3\xb3\x18\x9a\xb1\xb22\x9c\x1b\x1b\x9c\xb1\x1b2\x1d2\x93\x97\x10#\xb4\xbb2\x90:42\x900\xba\xba42\xb7:4\xb1\xb0\xba4\xb7\xb7\x101\xb7\xb22\x900\xb9\x90360\xb3\x900\xb3:2\xb9\x102\xb71\xb7\xb24\xb73\x90\x1410\xb9\xb2\x9b\x1a\x14\x904\xba\x17&#x27;</span><br></pre></td></tr></table></figure>

<p>Ở đây mình nhận thấy ở đầu của <code>decoded_bin</code> có mã hex <code>705f6374667b = p_ctf&#123;</code>, nên mình đã xóa đi một số bit cuối của <code>decoded_bin</code> cho đến khi nhận được đoạn mã đọc được:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">decoded_bin = b&#x27;11100000101111101100011011101000110011001111011011101000110100001101001011100110101111101101001011100110101111101101110011011110111010001011111011101000110100001100101010111110110011001101100011000010110011101111101000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100000101000001010000010100101010101110011011001010010000001000101011101100110000101110010011010010111001101110100011001010010011101110011001000000110100001100101011011000111000000100000011000010110011001110100011001010111001000100000011101100110100101110011011010010111010001101001011011100110011100100000011101000110100001100101001000000110001101101111011011000110111101110011011100110110010101110101011011010010000001100110011011110111001000100000011010010111011000100000011101000110111100100000011001010110111001100011011100100111100101110000011101000010000001110100011010000110010100100000011100000110110001100001011010010110111001110100011001010111100001110100001000000111010101110011011010010110111001100111001000000111001101100001011011010110010100100000011010110110010101111000001000000110000101101110011001000010000001101001011101100011110100100111011001110110010000110011011001100110010101100011011000100011011001100111011001100011000100110101011000110110010001100101001110000011011000110111001110010110001000110110011001000011101001100101001001110010111000100000010001110110100101110110011001010010000001110100011010000110010100100000011000010111010101110100011010000110010101101110011101000110100101100011011000010111010001101001011011110110111000100000011000110110111101100100011001010010000001100001011100110010000001100110011011000110000101100111001000000110000101100110011101000110010101110010001000000110010101101110011000110110111101100100011010010110111001100111001000000010100001100010011000010111001101100101001101100011010000101001001000000110100101110100&#x27;</span><br><span class="line">decoded_str = &quot;p_ctf&#123;this_is_not_the_flag&#125;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUse Evariste&#x27;s help after visiting the colosseum for iv to encrypt the plaintext using same kex and iv=&#x27;gd3fecb6gf15cde8679b6d:e&#x27;. Give the authentication code as flag after encoding (base64) it.&quot;</span><br></pre></td></tr></table></figure>

<p>Đến đây thì mình chịu :)) Tiếp theo là giải theo hint từ những người đã giải được trong server discord:  Sử dụng <a target="_blank" rel="noopener" href="https://github.com/danielmuthama/Hamming-Code"><em>hamming code</em></a>, ta phát hiện được 1 error trong quá trình truyền <code>encoded_str</code>: phát hiện và sử lỗi 1 bit <code>kex</code> -&gt; <code>key</code>. Plain đúng là</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;p_ctf&#123;this_is_not_the_flag&#125;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUse Evariste&#x27;s help after visiting the colosseum for iv to encrypt the plaintext using same key and iv=&#x27;gd3fecb6gf15cde8679b6d:e&#x27;. Give the authentication code as flag after encoding (base64) it.&quot;</span><br></pre></td></tr></table></figure>

<p>Chúng ta cũng nhận thấy rằng <code>IV</code> không phải là 1 đoạn hex dài 12 bytes bình thường, có vẻ như <code>iv</code> này cũng đã được mã hóa, thử với mã Caesa (sử dụng bảng mã <strong>ACSII 127 ký tự</strong>) thu được đoạn hex: <code>gd3fecb6gf15cde8679b6d:e</code> -&gt; <code>fc2edba5fe04bcd7568a5c9d</code>. Dữ kiện <em>“Evariste’s help after visiting the colosseum”</em> cho ta cái tên Galuois và sử dụng <strong>AES-GCM</strong> để giải. Cuối cùng là mã hóa và lấy MAC (message authen code) để submit đáp án.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">key = sha256(<span class="string">&quot;128bit_secretkey&quot;</span>.encode()).digest()</span><br><span class="line">iv = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;fc2edba5fe04bcd7568a5c9d&quot;</span>)</span><br><span class="line"></span><br><span class="line">pt = <span class="string">b&quot;p_ctf&#123;this_is_not_the_flag&#125;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUse Evariste&#x27;s help after visiting the colosseum for iv to encrypt the plaintext using same key and iv=&#x27;gd3fecb6gf15cde8679b6d:e&#x27;. Give the authentication code as flag after encoding (base64) it.&quot;</span></span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_GCM, nonce= iv)</span><br><span class="line">ct, mac = cipher.encrypt_and_digest(pt) </span><br><span class="line"><span class="built_in">print</span>(b64encode(mac))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p_ctf&#123;abJOd6K9aQYOrtl69D79rA==&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Compromised-481"><a href="#Compromised-481" class="headerlink" title="Compromised (481)"></a>Compromised (481)</h2><blockquote>
<p>Officer Eve suspects Alice and Bob to be performing illegal activities. You have obtained the code that runs on server. Help Eve to break in to their communications.<br>Server access: <code>nc compromised.ctf.pragyan.org 56931</code><br>Files: <code>script.py</code></p>
</blockquote>
<figure class="highlight python"><figcaption><span>script.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_too_much_evil</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">if</span> y &lt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    z = x//y</span><br><span class="line">    <span class="keyword">while</span> z&amp;<span class="number">1</span> == <span class="number">0</span>:</span><br><span class="line">        z &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> z == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">magic</span>(<span class="params">key</span>):</span><br><span class="line">    flag = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&#x27;rb&#x27;</span>).readline()</span><br><span class="line">    key = sha256(long_to_bytes(key)).digest()</span><br><span class="line">    iv = urandom(AES.block_size)    <span class="comment"># AES.block_size = 16</span></span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    ct = iv + aes.encrypt(pad(flag, AES.block_size))</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line">p = <span class="number">143631585913210514235039010914091901837885309376633126253342809551771176885137171094877459999188913342142748419620501172236669295062606053914284568348811271223549440680905140640909882790482660545326407684050654315851945053611416821020364550956522567974906505478346737880716863798325607222759444397302795988689</span></span><br><span class="line">g = <span class="number">65537</span></span><br><span class="line">o = p-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    eve = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;Eve\&#x27;s evil number: &#x27;</span>), <span class="number">16</span>)</span><br><span class="line">    <span class="keyword">if</span> is_too_much_evil(o, eve):</span><br><span class="line">        <span class="keyword">raise</span> Exception</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">alice_secret = randrange(<span class="number">2</span>, o)</span><br><span class="line">recv_alice = <span class="built_in">pow</span>(g, alice_secret, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Received from Alice:&#x27;</span>, <span class="built_in">hex</span>(recv_alice)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">send_bob = <span class="built_in">pow</span>(recv_alice, eve, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Sent to Bob:&#x27;</span>, <span class="built_in">hex</span>(send_bob)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">bob_scret = randrange(<span class="number">2</span>, o)</span><br><span class="line">recv_bob = <span class="built_in">pow</span>(g, bob_scret, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Received from Bob:&#x27;</span>, <span class="built_in">hex</span>(recv_bob)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">send_alice = <span class="built_in">pow</span>(recv_bob, eve, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Sent to Alice:&#x27;</span>, <span class="built_in">hex</span>(send_alice)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">pow</span>(send_alice, alice_secret, p)</span><br><span class="line"><span class="keyword">if</span> key != <span class="built_in">pow</span>(send_bob, bob_scret, p):</span><br><span class="line">    sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Ciphertext:&#x27;</span>, magic(key).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>

<p>Bài này nói về sơ đồ trao khóa Diffie–Hellman (<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange"><em>Diffie–Hellman key exchange</em></a> - DHKE), tóm tắt đề như sau:</p>
<ol>
<li>Chúng ta không bị giới hạn số lần thử số <em>eve</em> trên server;</li>
<li>Chúng ta biết giá trị <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo separator="true">,</mo><mi>g</mi><mo separator="true">,</mo><msup><mi>g</mi><mi>a</mi></msup><mo separator="true">,</mo><msup><mi>g</mi><mi>b</mi></msup><mo separator="true">,</mo><msup><mi>g</mi><mrow><mi>a</mi><mi>e</mi></mrow></msup><mo separator="true">,</mo><msup><mi>g</mi><mrow><mi>b</mi><mi>e</mi></mrow></msup></mrow><annotation encoding="application/x-tex">p, g, g^a, g^b, g^{ae}, g^{be}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span></span></span></span>. Nhiệm vụ là tìm giá trị <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>e</mi><mi>y</mi><mo>=</mo><msup><mi>g</mi><mrow><mi>a</mi><mi>b</mi><mi>e</mi></mrow></msup></mrow><annotation encoding="application/x-tex">key = g^{abe}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span></span></span></span>;</li>
</ol>
<p>Đáng lẽ đây là 1 bài toán khó, nhưng ở đây ta có 2 phương án giải quyết:</p>
<ol>
<li>Chọn eve sao cho <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"></span></span> là một số sao cho ta dễ giải quyết bài toán <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Discrete_logarithm_problem"><em>discrete logarithm problem</em></a>, tìm <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo fence="true">(</mo><mtext> </mtext><msup><mrow><mo fence="true">(</mo><msup><mi>g</mi><mi>e</mi></msup><mo fence="true">)</mo></mrow><mi>a</mi></msup><mtext> </mtext><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">a = log\left( \, \left( g^e \right)^a \, \right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.054292em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span>, phương án này <strong>khó</strong>.</li>
<li>Chọn <em>eve</em> sao cho <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi>a</mi><mi>b</mi><mi>e</mi></mrow></msup><mo>≡</mo><mn>1</mn><mtext>  </mtext><mo stretchy="false">(</mo><mtext>mod </mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g^{abe} \equiv 1 \; (\text{mod } p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord text"><span class="mord">mod </span></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> với xác suất cao, từ đây có thể sử dụng ngay giá trị <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>e</mi><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">key = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>.</li>
</ol>
<p>Chúng ta sẽ đi theo phương án 2, bypass hàm check khá đơn giản (thank @bronson113 discord), cơ sở lý thuyết như sau:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>∣</mo><mi>o</mi><mo>=</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo>=</mo><mn>16</mn><mo>×</mo><mn>4...</mn><mtext>  </mtext><mo separator="true">;</mo><mtext>  </mtext><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mi>g</mi><mi>e</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo></mrow><mrow><mi>G</mi><mi>C</mi><mi>D</mi><mrow><mo fence="true">(</mo><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>e</mi><mo fence="true">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">  
ord(g)\mid o=p-1=16\times4...\;;\;ord(g^{e})=\frac{ord(g)}{GCD\left(ord(g),e\right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">o</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">e</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>

<p>Chọn <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>3</mn><mo>×</mo><mi>o</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mn>16</mn></mrow><annotation encoding="application/x-tex">e = 3 \times o // 16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">o</span><span class="mord">/</span><span class="mord">/</span><span class="mord">1</span><span class="mord">6</span></span></span></span>, giá trị <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>o</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>e</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">z = o // e = 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">o</span><span class="mord">/</span><span class="mord">/</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span> -&gt; bypass. Lúc này </p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mi>g</mi><mi>e</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo></mrow><mrow><mi>G</mi><mi>C</mi><mi>D</mi><mrow><mo fence="true">(</mo><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>e</mi><mo fence="true">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mi>o</mi><mrow><mi>G</mi><mi>C</mi><mi>D</mi><mo stretchy="false">(</mo><mi>o</mi><mo separator="true">,</mo><mfrac><mrow><mn>3</mn><mo>×</mo><mi>o</mi></mrow><mn>16</mn></mfrac><mo stretchy="false">)</mo></mrow></mfrac><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">  
ord(g^{e})=\frac{ord(g)}{GCD\left(ord(g),e\right)}=\frac{o}{GCD(o,\frac{3\times o}{16})}=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">e</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.1876680000000004em;vertical-align:-1.080108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.10756em;"><span style="top:-2.2648919999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight">o</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">o</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.080108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span></span></span></span></span>

<p>Chúng ta mong muốn cặp số ngẫu nhiên <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a, b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span></span></span></span> sao cho <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>16</mn><mo>∣</mo><mi>a</mi><mo>×</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">16 \mid a \times b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span>. Sau 1 vài lần thử, mình đã thu được flag:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">&quot;compromised.ctf.pragyan.org&quot;</span>, <span class="number">56931</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="number">143631585913210514235039010914091901837885309376633126253342809551771176885137171094877459999188913342142748419620501172236669295062606053914284568348811271223549440680905140640909882790482660545326407684050654315851945053611416821020364550956522567974906505478346737880716863798325607222759444397302795988689</span></span><br><span class="line">g = <span class="number">65537</span></span><br><span class="line">o = p-<span class="number">1</span></span><br><span class="line">eve = <span class="built_in">hex</span>((<span class="number">3</span> * o) // <span class="number">16</span>)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;Eve\&#x27;s evil number: &#x27;</span>, eve.encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    r.recvline().decode().strip(<span class="string">&#x27;\n&#x27;</span>)   <span class="comment"># ta không quan tâm những giá trị g^a, g^b, g^ae, g^be</span></span><br><span class="line"></span><br><span class="line">ct = r.recvline().decode().strip(<span class="string">&#x27;\n&#x27;</span>)[<span class="number">12</span>:]</span><br><span class="line"><span class="built_in">print</span>(ct)</span><br><span class="line">iv = <span class="built_in">bytes</span>.fromhex(ct[:<span class="number">32</span>])</span><br><span class="line">ct = <span class="built_in">bytes</span>.fromhex(ct[<span class="number">32</span>:])</span><br><span class="line">key = sha256(long_to_bytes(<span class="number">1</span>)).digest()</span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    pt = aes.decrypt(ct).decode()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    exit(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(pt)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p_ctf&#123;7hi5_1s_su86r0up_6on51nem3n7_a774ck_on_DH&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Broken-Hash-500"><a href="#Broken-Hash-500" class="headerlink" title="Broken Hash (500)"></a>Broken Hash (500)</h2><blockquote>
<p>Can you extract an image from the two strings with same hash<br>Note: image bytes are encrypted<br>Hint: length of strings in <code>key_gen.py</code> is less than the strings given in <code>strings.txt</code>.<br>Files: <code>key_gen.py</code>, <code>strings.txt</code>.</p>
</blockquote>
<figure class="highlight python"><figcaption><span>key_gen.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> urlsafe_b64encode</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line"></span><br><span class="line">str1: <span class="built_in">hex</span> = <span class="string">&quot;--REDACTED--&quot;</span></span><br><span class="line">str2: <span class="built_in">hex</span> = <span class="string">&quot;--REDACTED--&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">hash</span> = md5(<span class="built_in">bytes</span>.fromhex(str1)).hexdigest()     <span class="comment"># &#x27;99b18a48309cd4d5681ddcd553a27fbf&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">hash</span> == md5(<span class="built_in">bytes</span>.fromhex(str2)).hexdigest()</span><br><span class="line"></span><br><span class="line">key = urlsafe_b64encode(<span class="built_in">hash</span>.encode())          <span class="comment">#  b&#x27;OTliMThhNDgzMDljZDRkNTY4MWRkY2Q1NTNhMjdmYmY=&#x27;</span></span><br><span class="line">f = Fernet(key)</span><br></pre></td></tr></table></figure>

<figure class="highlight text"><figcaption><span>strings.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2800000000063f0c24262a086dc3e3725d2f4c8c639c4872d8fe25c0502b2cc0d8841d692740e90eeaa9397a5910ef265b08f2463fe996cf1b2b4630e9d183f84b5bf1b6c36c369ac7e69b7c027cd0eafcddcf2fda47f88cacba71be1623b7aef2ccd68b02d7ba4475818684f2ba170bb35d67ba9bcf929dfaca50b70c5f012803b41ae44d3f3d7f898fbf2e1461c063c2bab34387fca00eb9ef452e674d13f7c38dbddd20b0ef5104d7e4a13c8eae8b19b9b28fbf596212be066308a5d94bf1c8702913c30d9024475f03ae898a710beb93d762598220e28c57c2f23db89aff049d46c927d5c48f3902f8ce815b1890fba30992735b6fedbc42bc67516ed34fd901f57f4f606244efda437f8a201ff518553030745ac03bb50597f8f324f7b469346f1057c9ac764a27f0bdbccc0c9215e79fe402b4c7f1356631e462546f16859dc6dfda4d0dfe7167d82ffd8ea27fcd738cfa18b37153c6f878327a9a6048f43588a0c81f2cabd0c9519964322416bd22c4375a4472c34f53cbe0638c9c2ce2ed0511101b1c1d48f173269a1c566add11433e03a9484352c0603092b379d6ec4645b0388c07698dfc0a5e99bbe73e83f19faca64460f212cf799e2e569682d5c225af3e5222df4a1c19d02201b191be79380accad3ada2736097a13c09bebeecab3fb2049d8071b19bc006078527aba76b5750d96f270766b9d74601c441b02cb824430f71222de4491bd265c399d5a7c79519d1c3e73982fda34e22166dfa7420f3fb0e6e1202461ca0ae92a7c1ff2d3bb5977ccf0bd246429711db28d6eaccc333d97cf2ad56eb5a77d6138e2ee9131908485a23bbeee53666c312ebcf533a04efef8dae582396322847b904a6d8740f9154573dd36ad5a167fe6c6db608b33ece02c9860825cb12463cdac15f86ecda71d6207b212a37a7c999f217ddb9d69dd795e112accc61909ba08155ddd50b6eaa27b93de65d57c22d711f333e9f16a5da0c248219fdfa03e1a737da9b6c28def7657b72c4977054b66f788f623121b2c6ff788c609a42f7202bb6985a6b2fa1af682f4cbc0c29ad28e3c977f5bcfc4cc091a06830fcae8f7e74ff8b5841dc319eb19ca6de66245a796ac8504d42ea2cf14751ec9a7f6a0b438055eadac7b012f2f6c9f3adce0769589a8e40e9a1847c9a0ca970b17d26755cd4ccc1926fea4b9fa845e0d8fce1d72e03aa0c6b04cc47ad746155d2c275893ee989c285dd3e41de8db72a82999efe69c3635ab204b1e8f16f37f87cc2c8fbe1aaa950e83f8782dbd9d4dc4527603d0142407585c748011102e3b5261a15b5f678ae05d3d43aa103609b40cdd8ec971fa2bf1fff8fee43c7d098e012c3d3ca1b3f4ca86efb4f5a959f483af7308ad5cb32c0f562a5c614afec2a513473e388d588bf154a977d9ea7e916afdbffabd17b7044ee7c01ab5fa4a99e6969a546bf359307427cea43d028b957c3ed6cfbb1b499a24554242d4a4407e4dcfbfeffcbf50fb3efb25f619c504318b554981704624a18f21adee3fe735932bd5ffb6b2f30f7908ca9c33e2f91ea262b35f2396a2640de32edda28435156bd2085e9b429f0dd496a3641da1b43c52bd983f7a26919f6f8675e2d494bceb3b05479261db44580216ea65a5ecb1faa0b4198ee50be0517d270fd770b426ad7afc7e508d4d8499cc5d679ec1bbee5dfafe3ad42a0525d42e907717961bed967ca78ec9c1964dabe3a6defcd34586051b8c0d15b5a6f5ef1066a36984d3991f24d7b900b48ce6f726a5aed75945851c3641d6814bce1fc7dba4fe9f527eb049a7ddc966a15317d61393482cc39998e0bad402aa3643f7fecb9b007312d178dd9c875ae16117b5ebc687274a5df63ac3c3458f77e673598ec2cdc9721ea9e6849ba5fe2b3920cf2d231fb6a200ed9a5bd7f959ff5c3b9e06e5b43493a2625bbc3baf21545f1939de09a785ba9f512d5c95d8bb8cfbec99a494622c02684ff08e1589e76b09bec850976670eba026b76f689f66eac7df2a4e5e0c70af21ee0ebdb6d5c25df9690a582d16a6cbc3942b156059513bc181bd5561b886e12e1e4f9c1885ad728e62c9c83cb804a777ec632bb2ac6a2544f9f7c9534cf8fa4fa6923e7ec074ca135f171c6bfedf61cea79de0f504a4120756a5db150a19b5844639f804be95cbc7f2af3bbda5cba6b2184ec2839e680b0bd1eae394a54633f0b71f5415869562443de716aafb06e773f205eaef868781ca816fa3472f52c9c18d46a0f9f4089ace5eeec2feb3005149600627cdec2a3a802b66ef4f50d0a99250a44a14407d9392110e38b3c45a870b54dbe21b8ee1d2e58097671cef4d975a43cee3b5804c775cb3bc240230187cd7110fc9f09ecf6e82af32c6cca22e62807838b1d2a0fa4632fe714741cf0de3cfb44d0cee8227089b74bf9f8224e720f793fef5abc227f890cb6f9c3d2bc746592e2bef304ceba1084c5b80bf143dadc238d8d45fa7c9edc914a5e986fc2494962c229e6e63c10c0eb00a99f2adba00933aa6733971f091b3dc047111a30c021803e9e580cad1be2bf051622b3c4503713ffff6c38bb59a79329990e7669ad60bf97282d6c1989291a8eec25b5cd7cd7a4c66ed9264136e55eec447668b495ac4641f081d4401b5fbf5a19b91f160561ca80a761ac560e9b6fb0504b3ec250bdf741cf877fa174efcd72a25c0954a606b511e0948265279dabac005a09133f7d86162d52b84df10a20b50e0d84bbb461de7c147d09de78f425b921d9be22d328d7cd49b9337fb8572fefab66a80cb780bc0f97408ad58ddc92458aa3abebf04d7d0837ab23b1e7a47cbfe3a14151cacc828e575933792fd8f2f6835b5154d996b60319e7538c6a31fdacc7ab94d17bae062d9f5e90c4572911b1578268c3d13dbc21dd4cadfd42c5cc4b05fac2f88ef8a79ca1d323654f00a254d2e56c0dc361e5874dc2437c8dc6c3af3fc345373118d132aef16c77a78a715cab96d6fa666e816f3f6e0c5fe4df27056332e9ba80d5051fee49c985e03ca44a7dc99354fe5744c1451b8c4caa83939f55489372889faab80abdd578cb914b4ba772dd3c57fc90825eea1c5fb0f8532c12ed917853297fbed8f6c884ca778c28ec244e1d62833da477378f5d3f6a00b68c8a75dc97e66742ac5800fc43e53eabbe8268634986ff3d9a7364bc3d411a332ba9acb7358b495f4050017ab44475fe740a383c587703b238fcecba354328e61b2ff00005959ce823aba02d46cee338be23be58c75bf078a12c96e9190fd88840b0e0539ef2252e85eeab37f484ba5199532b47f9eaae837ce81c16b744dca62befffcf0242bd96ffc163927cb3e6bb041a02ad46d4c889a90b95e7533c187835b587b50130e307eea0b7e28ddcf54f203183323e8c5f1bd94468e5b6d716dc60a409eee21e2ac62857cb87d04568deaa10eb64bcaf4b211abe1abcaace0654e75acd9700c2db210419dcf8866acf45440951abbf58b54c5768cf97cdb03ead9aef8955e426ece0d819665f97f484f465bd795e5cdae5a2714297a9e865a7f534b533d4342a4c5494ef062651d492a78c2011cb8391937ad88d524f25216c75c6613e2246007b8cad6c95e1b406b2ceec2c88a9ab268f84e0420c219ad142088c0c4ac15e3183d9e48e2f2bd9d0bc2a7491b9cb40e6916020e0c1b6a12459e662e8371455beee8b0ccdee918ca199b04546ad23bf6699132d9f46e80d88abb04f80d828d39883051d7b8c3ef4f2c5e396b076902f1adb0b1058267df23fc22d7dd313d4f9b44d2432385d749453fa070ddebf474df2b917211d78c5c28f68ffd9a824333649be301a0a6c2e06f8301f29d461b84e3bae9ae9d6c06e1dfb2545e46e96ae6d70c5b0c00a3c5b93b08ea13e85ffb649c57e93360e37fb867215d009d8318470c02b5b90dd60dd45f30f43541014b6d9e7f9889b1856d11aa9e5f25fc065095e1993fa402be63655196370f8c0732058fb540ddc3dc08a0060339af777395a47b4988be89bd47372ff648c391409119efcb46987f5e7da68950e72f82750e98f2dd1ce708cfd789b4ee0ea7619ed916a094c5a8f8d7afc139b90dcd94ae0157dc85641d858b559009c9c38ccc237813d3b8491b331f7c617226753b3db0f55e2360718378ff4da4a2e47780362d541a0d9a002384c4b14c27f94bc4a30fb2798273a62da00db3260e16d8c000e14c7cb9bd3244f2e1d6774a9bd49a64a78c90372277d2e0e58ee755f1cb658c76ea45d6d801796de2a4705492ee8dc11d6ca830e297f6092f585de215024b3ec0b566f50c35e54476ca80b052cb8f67da904ce663e9de10848bc48ff6ccb4ec74f08d40cfeca9afbaf7f96b77dbca97a8d860fc6a360336121e338290073920fe6585473f10e468302c4121e5c269b0823aea9ff37a4b2a5f5e8845cd606d4d199a405108b24c373c814cfe7c1334719a69f9ec17034179ca4ab654ade657a40841174ca1d4add662704c1f66973858675033f6bdbd1b147ba12aca2b642d8e7ba40035d519d3179b82036a76715fd152c7fe3be4fc6da853826f3f77c309c0d5cb5c90ef7029df504a7a9224f00a352ceb02e248cf4f1e8e6e07b8c8152f5fa7de7806caeb9ccf40835bee6d240c032c2d0e8543d4c17999959435a0d1f6297bc9a9936bb75de5ee118ca6e2c4a5e759c16ed8ad16c422e16b91394e561acc450ce58e47ed55b77ca4b6424304d90cd3020ec7be541a7f0c30116a3acde1c3be5a7842264ea2975a076148372f73a4ca4a35d48a441d968204d55ae6cad03727e47b48179584e3e8eacfedbe51dd5956b53ade7a4c2ffe3db3b32976840c4c8687d26ebc201e40e55bae40f0d8a28d282b9ed110542a052cc7e89489244900f0e4167521a5faddaffb6500fc8c800e6bb95299c56a3c6d65d34f38b7d14aa547154bdaa8231c0a524ca82dbe37d73fa4dee12066e75cda7b36f2bba04d48d0c2fe1c83fc3b6b792eed270352e1431498950d036277c5e60b272758d15bc30e4f8bd236f7d40b9f4be13d400a76f5256a736a2127249f9c7d0b189b7988b1608f993ad2f836faa3b90bd0c1e22dab5a9ade2148ace1360a98befb96f9e1d31ec30eae6b2145b5cdbb7e2ea6ff1e2e6160c5bd56718bc77d937faec02801740ad4f7b2919d9ab303922089d5658a9ca8034f5ec1684a952b302b9562e0673acd9f1a6e11492cca28bbc8eae0263febaecc07d57dbdb1fec263d86e96372899094c19071b6d4fc9db01742230f3441776b00fbd4158cd1fb92f7e1090de791bf65628281b9ea113409e13d07bcfa1838a12965ea16955b5c5ab9d32879b9cf89b094a46eeb23a9bbe13c3660c1f967ddc56642a065279ef3adf5f3e886f46bf73819272857f9d1b424d1a40d7794b7b31abf20d4315e92b469961bc6ebeb53b86e4c0f9eb7499ca4ee2afbba78dbf99fb3783d5bc8867080cfd6e48961deaaed2119033955ab619da0a349261b3c671d0ae27dd6699948df6d421065d8b1248eae403d54a0bacfd02eb996af5bda97d37b40e8aec4ad8c37a9933bbfcba0f66d04756bb278bfc7670d1396dfddc33d0da78da5dd01c7f5d643c473b08e20605b06278d55a59106dc5b9290b59f1a9f4e6d2d0ea0232baa47c68e43308771bf4902e0ea521ca320820ba4442ae393ae4ebbfbc46c493cd95ea8850c9b8ad995a8dcfd1fe46f91364cd853c7727a9978aa7cefa4c6dc2e73afac7881a60268e419b9c3833b2b66267d6273d1011c11c5e9309c607ef7669552ebd73d6395ec7d05cea071c9022a5610f9beb4a3b569a6ab01c58a68e50e8285896359b9849518367041b8b6fb95eb9f2db641d88f7ac494100b05ff0438ce629115d21eb84a6e75a6a3eefca30471b02927b1357cc54c3e1b24b3ac188761dfb23cc8e0a3ce682b11a85fec3fe485d8f364bc816ed61e71dc8d33da33a9451bc86748c79c216842e46333ce45e73b06dc05a40e47f33a7f78b3caae85e65fc536b6269ceca76761880c0c97e4b6664e8f606607a31626b282499365fc6d6ef6dc524972cd7155c0730a0a363efb04456fccc20e8f29c4bfb9214944d52c06a1246c3c008aadaa21ee07f02847e9ba351ce83c80e5a8bf44afe0d70d4411c2b9e92eaa43ceaf1fe3e492bf8a2e6775f10b63b9734beafc4a7991c78448ea435ce1d135c7cdaf0a6adf16ab94b6e6cdea82581932ccdebc46075dcb3f695329a22ea4f4ec59f0638e6580975caf5d69840d3454a742a56883a231cc199b0da16a231856ab54f250fa5db984543b0e50de0af69f43208db285899b5a65563302bb023c9677c4d205c716df5099108a4d511b914cbe662ea823bdde03588bc3f7315a66eeade6365f2d0827f70f7aa54861726a542f5662c482843f90a708960f58208eeb10bbc2d6eafe3cfe46c74d6b62292d53a6b7d82dbdc147c3819ad2ddd288194418d02a61c6f8fc94118b4ff6258ff66a7361105e311213f3b18205d62178feba28bd26b299c20f2d68317704409baf6bc9aa7dd66c8b83b8c9a05e6e65c72560c104bbfd7d615fcb61d2c9c02f316256de024571a0ad4cb4c71f230f4115b2be304200dfe9ec0d6fb2ada5acda7eea74b8cf1477a935e2860843fdea58491fe50d5e6a793d5e597f2d306ac3f08f1da7a534eeba7b734dc7bf9572b44b1b8b96fd5bfc8dfc544d7ac52e31e3b50aa59339a0ababbf93da0b124c4117fd69fbd0f7a7e28a8c46c73fe212380e54552f5c2872a2bf3a6a1a9f3a5f10dff252331a25d08a74bc7de564af2e109adad5961df62bfbb502945c960cf96a2dab043f1cf4126cd7fa64e260f39ff0dd120959e105055605e1acaa4d89b64e051a06d5093807b5d316820c9f08cca102c64765cdef4aae4f45aa3279cc3539795b57571b369b600bc91805d38778ea78e2da734323a5c35d5803ab788a5ef277490f29a633f4e7d4efeaa9764b99169b5ca4c7f0d533ef5e1a8cc6f3e1bc38d8b0b9a1d4b5087d68312b084e0fb82f57e77275603881f53c3c69f6be61a2b742cd12e8652ac7fefd43db35731d8dddac28f6c78bdcf4340f19cf867a5eb2bd0079951fac68d9a541739e4d89e9e707695ebc303dc217d5829f9bed63ae753d9fe65d44bb3a04c1281d711d64941105063286fe8fa892780a562faf7bdcd10c0b69ea6f0093d5f19feb4f46a977674ddd3c137eb2ed6ca824f0cdc8e4466690ec812378300e73528bbcd4a13e1bb6759546721992425a4b8af751bb1935ccf1f4d318e412224aa1b9562a729ea120f1ca92ce0062b4d6f75a64d0d2dfab2ce77d05fc8ea7b73f49536527fbc06ca0db029f54698d820fc29c3d6a13201a0ddf9098820519eff32b6d160db1d60b039f4176d822d6e4eb13226969fa4a35a1a46cdc5915c4f2afade7da68451b7edc6f20f21978dcb16cbc458051cd225bbf4077d171d6c2d47935c1377e84fa9a19b0fefa7f04015f3fb8d4e95e81ed7d8aae0ed46d1d6dbb589991daa751b52e24b332be20eb8e5274b3b8c69755ac64e56f8710b6bb84b1437c6e6458f8f3eb58373c3df41f84ce563fa257da81e5b7f14003c9905fd5113aba446f75c8cf2d1b0966789a2ba746f911e9a1cc4ae427916d47eadedd95d103b5f650906c911ec40b1bf2aa6b4d767d520c04d461a489b70c18b80c82f7a57409c0085a4be233aa3a9a9f3839e18b2f64d32fc5b39597e66db4b1484dee84da0dd13f4e10d76949df633d0c3f2798ad2af6bd78e8959ad0f17ce658af607e6890883c6cdd4d6d8db2255deb4b71883c36164fbc1f0d9528f494a586d47e8152929b353ea78449267030e95869aeec27c70ee5178e7b1645f373f6763a514176ad1c1474db0d0797b730e352ea83db60e2c6472e5982175ca780fb0505a95a3adb853ae5c1377a015a09572fe73896c8edb8cb59596e4175d2699619ebf8fb075f4ee3211622f51afd110886902cb1493fb2aee0fd5e9591fac6bc75d1e01d5241237924e0d843e222f0805bb6cb25780e659b8ea7f5446aba027236fec34a492e00084c95fa0478ccace3691c2ac0d99e733eb6b0ffbc7cf12d072644b4b6512eba5157650f4e7007c9b762e0ab98cc4125d9bfcfc61783b6f5656735694b0a4aa4e3c3f6cb9cd8dfa8e67af2821a9a75d36891fc1967cdde556a35c25e0859d41c223586b4ce4de9d174bdab40cf1d2b328a28d2e1d47710b505c2c2f2b848c4936f4429ebf108b2056aa894bccc29649da708bb9e8667bcb4f8076f8f9e53829c91f2ce4f63f5e10f79abcf4276a9534c83a1e8ead7da7f8a0b41cc809905f65691061d207867c4a49ef3c1429ada4cbd3910c2484b563cc04aeac799926f3f64f5e10de6f743ef8f3629314f3d9069ed447541ead497a9b40f41acd4f55c94b6e804521349444b353b16b3f4039fe3c5c85df7928a0d1da63702c5f293fac7dcaa1c5d7329f1a7258bb0ab27208b395ac0ae4b183731e540fb7c18f8532a084daebd0c798e5ab5363227dfc8b3190682c4c933c18fdfbaa622388dbf1e388f13099f08ed73f45e420a9604219a861f78212e1f5d50a6729956d18aa1011b6aa1f5b9fef3b68804419928166c6d859cd84d2533c64b9f489ae7f88712d85282705a382c8176e21af7d8925b49e12e7272d52e9a138a8639aaa803b571573b39609317a29c2882857f7fcaf369a2fe48d602dc8216763d929eb6ce9614f53d821c70b2a7fca89c52bc96a4e384087a7dc2d8214b939852c79fe85bcf4cba76df4bb53013f2774da289801aea53d9b12700f740be1f62e0290e60d7f8f8e4661f9de7059ad6dd2bd3c36aacef5dba3b733a3f65c771142a21ade2902e8b0b0e55fbba0c2ad7c2bf792542d7ff5ea107a275950c81692df957412f6b4c4cbad89b00dd903e5458faf08f3c4070c3f5912eb66230475b74ec9d191e18539ac5cd62c55b900a290208477418ed6a89c640ddf66ebde7c8baa001d4ebcf0822dbdddc46d556b69dafb170dfaecb0318bfcdf0bee66d47451deed636eced72db0486e7fee97c25ab50a542e33a070e2513995269372417b02020d6ded8646a0bc9c36bcbc570f4c2c01d4af55bfde1e7a20f2337a2bbf22e3b20de02f874a8180a894eac8d1297ba80211a6555c5d5e880ea5c4f02fb1493950b08d2419e0f060ea4dd64c914f79f011a763cbc422612bc19a69e26c145bab55a08894d4e8ea44a203ae60935a2f056efa8487d3924ece0e35bb449c956680d197b53f14b290c2d840e033461d5414671983ded386a3093f2dc659ea3b7e85fb3df76beefb3db4c7645f3d8eb819496803b9a48aadca4d88a1e3556647bc685bbaf558e60234e21e4c8efb9337746903cdb62c7d5454d5e07c269a60c23fe33fd800e939fb94cc9cd1a5c3765c08b0950a112515b158b95c61a36fd7eb7a4976ed79acfcf446befe839f2f79dad5355e7c137b436e2082282925954c54a1f56b43f0668cde18922d20b26d178b38e1909e94cf7db7e31e1cf06c3ff180ce549a2f4572bde1792d0b696a9d9c0ef7b7350255cfc5f53b5a997a08a822094696fdb9f72e4acd892982e5cb36f427471c2c76b7589a3e82d5c38b7fa57d3fa6b4e858de7092f48a76120570a7b02f28ba766a054455c2664c2161390c0a3d632226fcf9771474cd2dfb805905b5a5c17b8d7db6d92675c78415d2f55100e501d849d8d92247a9845d14909f49119152ecff64518c69c41eda50a7e87f977e2d03d3a323647c3fc03eb2e5454685e8f99fa63f851719b8fa2881f3ceb257b813f449bd7283e1b98478b3a213a593d300414625415f19b09f962e2264c0f1e8986f0178f7ea0098d87faf95a427ad57326d4b2ec98d32375b7d81edb5060900ba5da15c3fc3ebe504d8a023e5f904ae7b1e7115bf9f3da3d334394e650f18eabe5ed7e8e325f60097e227b2a6543a09def2e762016076eaca4acdcda7191a6f7d5a4f1aa390f4ed403823c2bd6b645bbf22c252c1cb7696965784329c19307fec170e38bec871b6718a6444cd7eaa23e0af1d3006e5bb37e1cab38792cf5e00003fdb860d68b41e17711182583111e115f69071dbe79b5b4081ac501ad69064d77391767ffa5a798ffd4841c4a967ee001a91939daf332e5d49044d2b17271617d95065018d684f0192dc2f805c3a644f466ce8dacb881c7413e99d809e3786265886a265a9b9a0d72dfcb4fcd65e4a5f866ea4ad74a96eab5c9cacd6ac0052e6b59d3c954e760acfb280982b7476b96cf018bcc033fdc113b8f84632593b1c09cdb1eb56bd90314f0ffdf562bfc6170fffb732c8e8ed862d99c54bfe2666216361516f46f8e22598e47be59e61716a80cc953a517516f10a5511f27511625215707588c78ffc259e4599e383932a48ca177b20c4d8c55d8d9336b77c832d07e11e373cef020837dfe3f687cbb83dac529d86114e727a5d9a587aa520334d6590e6f576f64382dfb9dd398ec33833405d1fec82f9e4b3bc73c19d302fb60434cf7f77b26c23d5ce9f503f129784f63546ebea9cae7e76de3b6788ac15f9fbabd0e8901f29124da858ade5c29d6a2938d4620668fd90163049af59fd627c32aa9d432d2b3073352270632f5436c267380a54bed9abe8e894f3dcb20a11cf07de336ad2ca347cb3262ebef3daebaf6822ccf002eb22647d7b591f233f745672facda6a575f6139c0383f1dc298c9927e892ae534a041412879098e0f6c35c1cbcfcb893a8f75ed272d2ac8091caa54488ae5d4541c60739d6cee6b91c6debe0605d402846f0aa69372315288de</span><br><span class="line">4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa202a8284bf36e8e4b55b35f427593d849676da0d1d55d8360fb5f07fea2800000000063f0c24262a086dc3e3725d2f4c8c639c4872d8fe25c0502b2cc0d8841d692740e90eeaa9397a5910ef265b08f2463fe996cf1b2b4630e9d183f84b5bf1b6c36c369ac7e69b7c027cd0eafcddcf2fda47f88cacba71be1623b7aef2ccd68b02d7ba4475818684f2ba170bb35d67ba9bcf929dfaca50b70c5f012803b41ae44d3f3d7f898fbf2e1461c063c2bab34387fca00eb9ef452e674d13f7c38dbddd20b0ef5104d7e4a13c8eae8b19b9b28fbf596212be066308a5d94bf1c8702913c30d9024475f03ae898a710beb93d762598220e28c57c2f23db89aff049d46c927d5c48f3902f8ce815b1890fba30992735b6fedbc42bc67516ed34fd901f57f4f606244efda437f8a201ff518553030745ac03bb50597f8f324f7b469346f1057c9ac764a27f0bdbccc0c9215e79fe402b4c7f1356631e462546f16859dc6dfda4d0dfe7167d82ffd8ea27fcd738cfa18b37153c6f878327a9a6048f43588a0c81f2cabd0c9519964322416bd22c4375a4472c34f53cbe0638c9c2ce2ed0511101b1c1d48f173269a1c566add11433e03a9484352c0603092b379d6ec4645b0388c07698dfc0a5e99bbe73e83f19faca64460f212cf799e2e569682d5c225af3e5222df4a1c19d02201b191be79380accad3ada2736097a13c09bebeecab3fb2049d8071b19bc006078527aba76b5750d96f270766b9d74601c441b02cb824430f71222de4491bd265c399d5a7c79519d1c3e73982fda34e22166dfa7420f3fb0e6e1202461ca0ae92a7c1ff2d3bb5977ccf0bd246429711db28d6eaccc333d97cf2ad56eb5a77d6138e2ee9131908485a23bbeee53666c312ebcf533a04efef8dae582396322847b904a6d8740f9154573dd36ad5a167fe6c6db608b33ece02c9860825cb12463cdac15f86ecda71d6207b212a37a7c999f217ddb9d69dd795e112accc61909ba08155ddd50b6eaa27b93de65d57c22d711f333e9f16a5da0c248219fdfa03e1a737da9b6c28def7657b72c4977054b66f788f623121b2c6ff788c609a42f7202bb6985a6b2fa1af682f4cbc0c29ad28e3c977f5bcfc4cc091a06830fcae8f7e74ff8b5841dc319eb19ca6de66245a796ac8504d42ea2cf14751ec9a7f6a0b438055eadac7b012f2f6c9f3adce0769589a8e40e9a1847c9a0ca970b17d26755cd4ccc1926fea4b9fa845e0d8fce1d72e03aa0c6b04cc47ad746155d2c275893ee989c285dd3e41de8db72a82999efe69c3635ab204b1e8f16f37f87cc2c8fbe1aaa950e83f8782dbd9d4dc4527603d0142407585c748011102e3b5261a15b5f678ae05d3d43aa103609b40cdd8ec971fa2bf1fff8fee43c7d098e012c3d3ca1b3f4ca86efb4f5a959f483af7308ad5cb32c0f562a5c614afec2a513473e388d588bf154a977d9ea7e916afdbffabd17b7044ee7c01ab5fa4a99e6969a546bf359307427cea43d028b957c3ed6cfbb1b499a24554242d4a4407e4dcfbfeffcbf50fb3efb25f619c504318b554981704624a18f21adee3fe735932bd5ffb6b2f30f7908ca9c33e2f91ea262b35f2396a2640de32edda28435156bd2085e9b429f0dd496a3641da1b43c52bd983f7a26919f6f8675e2d494bceb3b05479261db44580216ea65a5ecb1faa0b4198ee50be0517d270fd770b426ad7afc7e508d4d8499cc5d679ec1bbee5dfafe3ad42a0525d42e907717961bed967ca78ec9c1964dabe3a6defcd34586051b8c0d15b5a6f5ef1066a36984d3991f24d7b900b48ce6f726a5aed75945851c3641d6814bce1fc7dba4fe9f527eb049a7ddc966a15317d61393482cc39998e0bad402aa3643f7fecb9b007312d178dd9c875ae16117b5ebc687274a5df63ac3c3458f77e673598ec2cdc9721ea9e6849ba5fe2b3920cf2d231fb6a200ed9a5bd7f959ff5c3b9e06e5b43493a2625bbc3baf21545f1939de09a785ba9f512d5c95d8bb8cfbec99a494622c02684ff08e1589e76b09bec850976670eba026b76f689f66eac7df2a4e5e0c70af21ee0ebdb6d5c25df9690a582d16a6cbc3942b156059513bc181bd5561b886e12e1e4f9c1885ad728e62c9c83cb804a777ec632bb2ac6a2544f9f7c9534cf8fa4fa6923e7ec074ca135f171c6bfedf61cea79de0f504a4120756a5db150a19b5844639f804be95cbc7f2af3bbda5cba6b2184ec2839e680b0bd1eae394a54633f0b71f5415869562443de716aafb06e773f205eaef868781ca816fa3472f52c9c18d46a0f9f4089ace5eeec2feb3005149600627cdec2a3a802b66ef4f50d0a99250a44a14407d9392110e38b3c45a870b54dbe21b8ee1d2e58097671cef4d975a43cee3b5804c775cb3bc240230187cd7110fc9f09ecf6e82af32c6cca22e62807838b1d2a0fa4632fe714741cf0de3cfb44d0cee8227089b74bf9f8224e720f793fef5abc227f890cb6f9c3d2bc746592e2bef304ceba1084c5b80bf143dadc238d8d45fa7c9edc914a5e986fc2494962c229e6e63c10c0eb00a99f2adba00933aa6733971f091b3dc047111a30c021803e9e580cad1be2bf051622b3c4503713ffff6c38bb59a79329990e7669ad60bf97282d6c1989291a8eec25b5cd7cd7a4c66ed9264136e55eec447668b495ac4641f081d4401b5fbf5a19b91f160561ca80a761ac560e9b6fb0504b3ec250bdf741cf877fa174efcd72a25c0954a606b511e0948265279dabac005a09133f7d86162d52b84df10a20b50e0d84bbb461de7c147d09de78f425b921d9be22d328d7cd49b9337fb8572fefab66a80cb780bc0f97408ad58ddc92458aa3abebf04d7d0837ab23b1e7a47cbfe3a14151cacc828e575933792fd8f2f6835b5154d996b60319e7538c6a31fdacc7ab94d17bae062d9f5e90c4572911b1578268c3d13dbc21dd4cadfd42c5cc4b05fac2f88ef8a79ca1d323654f00a254d2e56c0dc361e5874dc2437c8dc6c3af3fc345373118d132aef16c77a78a715cab96d6fa666e816f3f6e0c5fe4df27056332e9ba80d5051fee49c985e03ca44a7dc99354fe5744c1451b8c4caa83939f55489372889faab80abdd578cb914b4ba772dd3c57fc90825eea1c5fb0f8532c12ed917853297fbed8f6c884ca778c28ec244e1d62833da477378f5d3f6a00b68c8a75dc97e66742ac5800fc43e53eabbe8268634986ff3d9a7364bc3d411a332ba9acb7358b495f4050017ab44475fe740a383c587703b238fcecba354328e61b2ff00005959ce823aba02d46cee338be23be58c75bf078a12c96e9190fd88840b0e0539ef2252e85eeab37f484ba5199532b47f9eaae837ce81c16b744dca62befffcf0242bd96ffc163927cb3e6bb041a02ad46d4c889a90b95e7533c187835b587b50130e307eea0b7e28ddcf54f203183323e8c5f1bd94468e5b6d716dc60a409eee21e2ac62857cb87d04568deaa10eb64bcaf4b211abe1abcaace0654e75acd9700c2db210419dcf8866acf45440951abbf58b54c5768cf97cdb03ead9aef8955e426ece0d819665f97f484f465bd795e5cdae5a2714297a9e865a7f534b533d4342a4c5494ef062651d492a78c2011cb8391937ad88d524f25216c75c6613e2246007b8cad6c95e1b406b2ceec2c88a9ab268f84e0420c219ad142088c0c4ac15e3183d9e48e2f2bd9d0bc2a7491b9cb40e6916020e0c1b6a12459e662e8371455beee8b0ccdee918ca199b04546ad23bf6699132d9f46e80d88abb04f80d828d39883051d7b8c3ef4f2c5e396b076902f1adb0b1058267df23fc22d7dd313d4f9b44d2432385d749453fa070ddebf474df2b917211d78c5c28f68ffd9a824333649be301a0a6c2e06f8301f29d461b84e3bae9ae9d6c06e1dfb2545e46e96ae6d70c5b0c00a3c5b93b08ea13e85ffb649c57e93360e37fb867215d009d8318470c02b5b90dd60dd45f30f43541014b6d9e7f9889b1856d11aa9e5f25fc065095e1993fa402be63655196370f8c0732058fb540ddc3dc08a0060339af777395a47b4988be89bd47372ff648c391409119efcb46987f5e7da68950e72f82750e98f2dd1ce708cfd789b4ee0ea7619ed916a094c5a8f8d7afc139b90dcd94ae0157dc85641d858b559009c9c38ccc237813d3b8491b331f7c617226753b3db0f55e2360718378ff4da4a2e47780362d541a0d9a002384c4b14c27f94bc4a30fb2798273a62da00db3260e16d8c000e14c7cb9bd3244f2e1d6774a9bd49a64a78c90372277d2e0e58ee755f1cb658c76ea45d6d801796de2a4705492ee8dc11d6ca830e297f6092f585de215024b3ec0b566f50c35e54476ca80b052cb8f67da904ce663e9de10848bc48ff6ccb4ec74f08d40cfeca9afbaf7f96b77dbca97a8d860fc6a360336121e338290073920fe6585473f10e468302c4121e5c269b0823aea9ff37a4b2a5f5e8845cd606d4d199a405108b24c373c814cfe7c1334719a69f9ec17034179ca4ab654ade657a40841174ca1d4add662704c1f66973858675033f6bdbd1b147ba12aca2b642d8e7ba40035d519d3179b82036a76715fd152c7fe3be4fc6da853826f3f77c309c0d5cb5c90ef7029df504a7a9224f00a352ceb02e248cf4f1e8e6e07b8c8152f5fa7de7806caeb9ccf40835bee6d240c032c2d0e8543d4c17999959435a0d1f6297bc9a9936bb75de5ee118ca6e2c4a5e759c16ed8ad16c422e16b91394e561acc450ce58e47ed55b77ca4b6424304d90cd3020ec7be541a7f0c30116a3acde1c3be5a7842264ea2975a076148372f73a4ca4a35d48a441d968204d55ae6cad03727e47b48179584e3e8eacfedbe51dd5956b53ade7a4c2ffe3db3b32976840c4c8687d26ebc201e40e55bae40f0d8a28d282b9ed110542a052cc7e89489244900f0e4167521a5faddaffb6500fc8c800e6bb95299c56a3c6d65d34f38b7d14aa547154bdaa8231c0a524ca82dbe37d73fa4dee12066e75cda7b36f2bba04d48d0c2fe1c83fc3b6b792eed270352e1431498950d036277c5e60b272758d15bc30e4f8bd236f7d40b9f4be13d400a76f5256a736a2127249f9c7d0b189b7988b1608f993ad2f836faa3b90bd0c1e22dab5a9ade2148ace1360a98befb96f9e1d31ec30eae6b2145b5cdbb7e2ea6ff1e2e6160c5bd56718bc77d937faec02801740ad4f7b2919d9ab303922089d5658a9ca8034f5ec1684a952b302b9562e0673acd9f1a6e11492cca28bbc8eae0263febaecc07d57dbdb1fec263d86e96372899094c19071b6d4fc9db01742230f3441776b00fbd4158cd1fb92f7e1090de791bf65628281b9ea113409e13d07bcfa1838a12965ea16955b5c5ab9d32879b9cf89b094a46eeb23a9bbe13c3660c1f967ddc56642a065279ef3adf5f3e886f46bf73819272857f9d1b424d1a40d7794b7b31abf20d4315e92b469961bc6ebeb53b86e4c0f9eb7499ca4ee2afbba78dbf99fb3783d5bc8867080cfd6e48961deaaed2119033955ab619da0a349261b3c671d0ae27dd6699948df6d421065d8b1248eae403d54a0bacfd02eb996af5bda97d37b40e8aec4ad8c37a9933bbfcba0f66d04756bb278bfc7670d1396dfddc33d0da78da5dd01c7f5d643c473b08e20605b06278d55a59106dc5b9290b59f1a9f4e6d2d0ea0232baa47c68e43308771bf4902e0ea521ca320820ba4442ae393ae4ebbfbc46c493cd95ea8850c9b8ad995a8dcfd1fe46f91364cd853c7727a9978aa7cefa4c6dc2e73afac7881a60268e419b9c3833b2b66267d6273d1011c11c5e9309c607ef7669552ebd73d6395ec7d05cea071c9022a5610f9beb4a3b569a6ab01c58a68e50e8285896359b9849518367041b8b6fb95eb9f2db641d88f7ac494100b05ff0438ce629115d21eb84a6e75a6a3eefca30471b02927b1357cc54c3e1b24b3ac188761dfb23cc8e0a3ce682b11a85fec3fe485d8f364bc816ed61e71dc8d33da33a9451bc86748c79c216842e46333ce45e73b06dc05a40e47f33a7f78b3caae85e65fc536b6269ceca76761880c0c97e4b6664e8f606607a31626b282499365fc6d6ef6dc524972cd7155c0730a0a363efb04456fccc20e8f29c4bfb9214944d52c06a1246c3c008aadaa21ee07f02847e9ba351ce83c80e5a8bf44afe0d70d4411c2b9e92eaa43ceaf1fe3e492bf8a2e6775f10b63b9734beafc4a7991c78448ea435ce1d135c7cdaf0a6adf16ab94b6e6cdea82581932ccdebc46075dcb3f695329a22ea4f4ec59f0638e6580975caf5d69840d3454a742a56883a231cc199b0da16a231856ab54f250fa5db984543b0e50de0af69f43208db285899b5a65563302bb023c9677c4d205c716df5099108a4d511b914cbe662ea823bdde03588bc3f7315a66eeade6365f2d0827f70f7aa54861726a542f5662c482843f90a708960f58208eeb10bbc2d6eafe3cfe46c74d6b62292d53a6b7d82dbdc147c3819ad2ddd288194418d02a61c6f8fc94118b4ff6258ff66a7361105e311213f3b18205d62178feba28bd26b299c20f2d68317704409baf6bc9aa7dd66c8b83b8c9a05e6e65c72560c104bbfd7d615fcb61d2c9c02f316256de024571a0ad4cb4c71f230f4115b2be304200dfe9ec0d6fb2ada5acda7eea74b8cf1477a935e2860843fdea58491fe50d5e6a793d5e597f2d306ac3f08f1da7a534eeba7b734dc7bf9572b44b1b8b96fd5bfc8dfc544d7ac52e31e3b50aa59339a0ababbf93da0b124c4117fd69fbd0f7a7e28a8c46c73fe212380e54552f5c2872a2bf3a6a1a9f3a5f10dff252331a25d08a74bc7de564af2e109adad5961df62bfbb502945c960cf96a2dab043f1cf4126cd7fa64e260f39ff0dd120959e105055605e1acaa4d89b64e051a06d5093807b5d316820c9f08cca102c64765cdef4aae4f45aa3279cc3539795b57571b369b600bc91805d38778ea78e2da734323a5c35d5803ab788a5ef277490f29a633f4e7d4efeaa9764b99169b5ca4c7f0d533ef5e1a8cc6f3e1bc38d8b0b9a1d4b5087d68312b084e0fb82f57e77275603881f53c3c69f6be61a2b742cd12e8652ac7fefd43db35731d8dddac28f6c78bdcf4340f19cf867a5eb2bd0079951fac68d9a541739e4d89e9e707695ebc303dc217d5829f9bed63ae753d9fe65d44bb3a04c1281d711d64941105063286fe8fa892780a562faf7bdcd10c0b69ea6f0093d5f19feb4f46a977674ddd3c137eb2ed6ca824f0cdc8e4466690ec812378300e73528bbcd4a13e1bb6759546721992425a4b8af751bb1935ccf1f4d318e412224aa1b9562a729ea120f1ca92ce0062b4d6f75a64d0d2dfab2ce77d05fc8ea7b73f49536527fbc06ca0db029f54698d820fc29c3d6a13201a0ddf9098820519eff32b6d160db1d60b039f4176d822d6e4eb13226969fa4a35a1a46cdc5915c4f2afade7da68451b7edc6f20f21978dcb16cbc458051cd225bbf4077d171d6c2d47935c1377e84fa9a19b0fefa7f04015f3fb8d4e95e81ed7d8aae0ed46d1d6dbb589991daa751b52e24b332be20eb8e5274b3b8c69755ac64e56f8710b6bb84b1437c6e6458f8f3eb58373c3df41f84ce563fa257da81e5b7f14003c9905fd5113aba446f75c8cf2d1b0966789a2ba746f911e9a1cc4ae427916d47eadedd95d103b5f650906c911ec40b1bf2aa6b4d767d520c04d461a489b70c18b80c82f7a57409c0085a4be233aa3a9a9f3839e18b2f64d32fc5b39597e66db4b1484dee84da0dd13f4e10d76949df633d0c3f2798ad2af6bd78e8959ad0f17ce658af607e6890883c6cdd4d6d8db2255deb4b71883c36164fbc1f0d9528f494a586d47e8152929b353ea78449267030e95869aeec27c70ee5178e7b1645f373f6763a514176ad1c1474db0d0797b730e352ea83db60e2c6472e5982175ca780fb0505a95a3adb853ae5c1377a015a09572fe73896c8edb8cb59596e4175d2699619ebf8fb075f4ee3211622f51afd110886902cb1493fb2aee0fd5e9591fac6bc75d1e01d5241237924e0d843e222f0805bb6cb25780e659b8ea7f5446aba027236fec34a492e00084c95fa0478ccace3691c2ac0d99e733eb6b0ffbc7cf12d072644b4b6512eba5157650f4e7007c9b762e0ab98cc4125d9bfcfc61783b6f5656735694b0a4aa4e3c3f6cb9cd8dfa8e67af2821a9a75d36891fc1967cdde556a35c25e0859d41c223586b4ce4de9d174bdab40cf1d2b328a28d2e1d47710b505c2c2f2b848c4936f4429ebf108b2056aa894bccc29649da708bb9e8667bcb4f8076f8f9e53829c91f2ce4f63f5e10f79abcf4276a9534c83a1e8ead7da7f8a0b41cc809905f65691061d207867c4a49ef3c1429ada4cbd3910c2484b563cc04aeac799926f3f64f5e10de6f743ef8f3629314f3d9069ed447541ead497a9b40f41acd4f55c94b6e804521349444b353b16b3f4039fe3c5c85df7928a0d1da63702c5f293fac7dcaa1c5d7329f1a7258bb0ab27208b395ac0ae4b183731e540fb7c18f8532a084daebd0c798e5ab5363227dfc8b3190682c4c933c18fdfbaa622388dbf1e388f13099f08ed73f45e420a9604219a861f78212e1f5d50a6729956d18aa1011b6aa1f5b9fef3b68804419928166c6d859cd84d2533c64b9f489ae7f88712d85282705a382c8176e21af7d8925b49e12e7272d52e9a138a8639aaa803b571573b39609317a29c2882857f7fcaf369a2fe48d602dc8216763d929eb6ce9614f53d821c70b2a7fca89c52bc96a4e384087a7dc2d8214b939852c79fe85bcf4cba76df4bb53013f2774da289801aea53d9b12700f740be1f62e0290e60d7f8f8e4661f9de7059ad6dd2bd3c36aacef5dba3b733a3f65c771142a21ade2902e8b0b0e55fbba0c2ad7c2bf792542d7ff5ea107a275950c81692df957412f6b4c4cbad89b00dd903e5458faf08f3c4070c3f5912eb66230475b74ec9d191e18539ac5cd62c55b900a290208477418ed6a89c640ddf66ebde7c8baa001d4ebcf0822dbdddc46d556b69dafb170dfaecb0318bfcdf0bee66d47451deed636eced72db0486e7fee97c25ab50a542e33a070e2513995269372417b02020d6ded8646a0bc9c36bcbc570f4c2c01d4af55bfde1e7a20f2337a2bbf22e3b20de02f874a8180a894eac8d1297ba80211a6555c5d5e880ea5c4f02fb1493950b08d2419e0f060ea4dd64c914f79f011a763cbc422612bc19a69e26c145bab55a08894d4e8ea44a203ae60935a2f056efa8487d3924ece0e35bb449c956680d197b53f14b290c2d840e033461d5414671983ded386a3093f2dc659ea3b7e85fb3df76beefb3db4c7645f3d8eb819496803b9a48aadca4d88a1e3556647bc685bbaf558e60234e21e4c8efb9337746903cdb62c7d5454d5e07c269a60c23fe33fd800e939fb94cc9cd1a5c3765c08b0950a112515b158b95c61a36fd7eb7a4976ed79acfcf446befe839f2f79dad5355e7c137b436e2082282925954c54a1f56b43f0668cde18922d20b26d178b38e1909e94cf7db7e31e1cf06c3ff180ce549a2f4572bde1792d0b696a9d9c0ef7b7350255cfc5f53b5a997a08a822094696fdb9f72e4acd892982e5cb36f427471c2c76b7589a3e82d5c38b7fa57d3fa6b4e858de7092f48a76120570a7b02f28ba766a054455c2664c2161390c0a3d632226fcf9771474cd2dfb805905b5a5c17b8d7db6d92675c78415d2f55100e501d849d8d92247a9845d14909f49119152ecff64518c69c41eda50a7e87f977e2d03d3a323647c3fc03eb2e5454685e8f99fa63f851719b8fa2881f3ceb257b813f449bd7283e1b98478b3a213a593d300414625415f19b09f962e2264c0f1e8986f0178f7ea0098d87faf95a427ad57326d4b2ec98d32375b7d81edb5060900ba5da15c3fc3ebe504d8a023e5f904ae7b1e7115bf9f3da3d334394e650f18eabe5ed7e8e325f60097e227b2a6543a09def2e762016076eaca4acdcda7191a6f7d5a4f1aa390f4ed403823c2bd6b645bbf22c252c1cb7696965784329c19307fec170e38bec871b6718a6444cd7eaa23e0af1d3006e5bb37e1cab38792cf5e00003fdb860d68b41e17711182583111e115f69071dbe79b5b4081ac501ad69064d77391767ffa5a798ffd4841c4a967ee001a91939daf332e5d49044d2b17271617d95065018d684f0192dc2f805c3a644f466ce8dacb881c7413e99d809e3786265886a265a9b9a0d72dfcb4fcd65e4a5f866ea4ad74a96eab5c9cacd6ac0052e6b59d3c954e760acfb280982b7476b96cf018bcc033fdc113b8f84632593b1c09cdb1eb56bd90314f0ffdf562bfc6170fffb732c8e8ed862d99c54bfe2666216361516f46f8e22598e47be59e61716a80cc953a517516f10a5511f27511625215707588c78ffc259e4599e383932a48ca177b20c4d8c55d8d9336b77c832d07e11e373cef020837dfe3f687cbb83dac529d86114e727a5d9a587aa520334d6590e6f576f64382dfb9dd398ec33833405d1fec82f9e4b3bc73c19d302fb60434cf7f77b26c23d5ce9f503f129784f63546ebea9cae7e76de3b6788ac15f9fbabd0e8901f29124da858ade5c29d6a2938d4620668fd90163049af59fd627c32aa9d432d2b3073352270632f5436c267380a54bed9abe8e894f3dcb20a11cf07de336ad2ca347cb3262ebef3daebaf6822ccf002eb22647d7b591f233f745672facda6a575f6139c0383f1dc298c9927e892ae534a041412879098e0f6c35c1cbcfcb893a8f75ed272d2ac8091caa54488ae5d4541c60739d6cee6b91c6debe0605d402846f0aa69372315288de</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/56997981/how-can-i-validate-a-fernet-token-without-using-the-key">Tìm hiểu về Fernet cipher</a>, ta nhận thấy rằng Fernet token có dạng sau</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">token = urlsafe_b64encode(Version ‖ Timestamp ‖ IV ‖ Ciphertext ‖ HMAC)</span><br></pre></td></tr></table></figure>

<p>Trong đó Version là byte đầu tiên và bắt đầu bằng <code>0x80</code>. Với hint từ @m1dm4n,  ta biết rằng 64 bytes đầu tiên gây ra collision, và encrypted img bắt đầu từ bytes thứ 65 trở đi. </p>
<p>Sử dụng gợi ý từ file <code>key_gen.py</code>, sau nhiều lần thử, <em>str1</em> dẫn đến <em>key</em> đúng là 64 bit đầu tiên:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4dc968ff0ee35c209572d4777b721587d36fa7b21bdc56b74a3dc0783e7b9518afbfa200a8284bf36e8e4b55b35f427593d849676da0d1555d8360fb5f07fea2</span><br></pre></td></tr></table></figure>

<p>Với bất kỳ đoạn <em>encrypted_img</em> nào ta cũng có thể tìm về img chứa flag ban đầu. Sử dụng key đã tìm được để giải mã <em>encrypted_img</em>, ta thu được 1 đoạn hex bắt đầu là <code>89504e47</code>, đây chính là header của file png tiêu chuẩn:</p>
<p><img src="/src/2023/Pragyan-CTF-2023/broken-hash-1.jpg"></p>
<p>Ghi đoạn hex vừa rồi vào file, ta thu được file ảnh:</p>
<p><img src="/src/2023/Pragyan-CTF-2023/broken-hash.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p_ctf&#123;60_N0T_u53_md5_f0r_h4sh1n6_p455wor55&#125;</span><br></pre></td></tr></table></figure></div><div class="article-licensing box"><div class="licensing-title"><p>Pragyan CTF 2023 Write-ups</p><p><a href="https://pinox0x0.github.io/2023/pragyan-ctf-2023-write-ups/">https://pinox0x0.github.io/2023/pragyan-ctf-2023-write-ups/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Pinox0x0</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2023-03-08</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2023-03-25</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/crypto/">crypto</a><a class="link-muted mr-2" rel="tag" href="/tags/CTF/">CTF</a><a class="link-muted mr-2" rel="tag" href="/tags/WriteUp/">WriteUp</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2023/davinci-ctf-2023/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">DavinciCTF 2023 Write-ups</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2023/kalmar-ctf-2023-write-ups/"><span class="level-item">Kalmar CTF 2023 Write-ups</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Pinox0x0"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Pinox0x0</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">6</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">2</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">4</p></a></div></div></nav></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Sanity-Check-10"><span class="level-left"><span class="level-item">1</span><span class="level-item">Sanity Check (10)</span></span></a></li><li><a class="level is-mobile" href="#Leaky-RSA-451"><span class="level-left"><span class="level-item">2</span><span class="level-item">Leaky RSA (451)</span></span></a></li><li><a class="level is-mobile" href="#CustomAESed-500"><span class="level-left"><span class="level-item">3</span><span class="level-item">CustomAESed (500)</span></span></a></li><li><a class="level is-mobile" href="#Compromised-481"><span class="level-left"><span class="level-item">4</span><span class="level-item">Compromised (481)</span></span></a></li><li><a class="level is-mobile" href="#Broken-Hash-500"><span class="level-left"><span class="level-item">5</span><span class="level-item">Broken Hash (500)</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Pinox0x0&#039;s Blog</a><p class="is-size-7"><span>&copy; 2023 Pinox0x0</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">© 2023 Pinox0x0</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>